"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "_action-browser_src_lib_excel_ts";
exports.ids = ["_action-browser_src_lib_excel_ts"];
exports.modules = {

/***/ "(action-browser)/./src/lib/excel.ts":
/*!**************************!*\
  !*** ./src/lib/excel.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ALLOWED_STATUSES: () => (/* binding */ ALLOWED_STATUSES),\n/* harmony export */   getAllOS: () => (/* binding */ getAllOS),\n/* harmony export */   getExcelData: () => (/* binding */ getExcelData),\n/* harmony export */   getOSById: () => (/* binding */ getOSById),\n/* harmony export */   invalidateExcelCache: () => (/* binding */ invalidateExcelCache)\n/* harmony export */ });\n/* harmony import */ var xlsx__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! xlsx */ \"(action-browser)/./node_modules/xlsx/xlsx.mjs\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs/promises */ \"fs/promises\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs_promises__WEBPACK_IMPORTED_MODULE_0__);\n\n\nconst ALLOWED_STATUSES = [\n    \"iniciar\",\n    \"em execu\\xe7\\xe3o\",\n    \"em execucao\",\n    \"pend. cliente\",\n    \"conclu\\xeddo\",\n    \"concluido\",\n    \"encerrada\",\n    \"cancelado\"\n];\nconst EXCEL_PATH = process.env.EXCEL_PATH || \"C:\\\\Programas\\\\PROJETOS\\\\planilha\\\\Os.xlsx\";\n// ─── In-Memory Cache with TTL ───────────────────────────────────────\nconst CACHE_TTL_MS = 60 * 1000; // 60 seconds\nlet cache = null;\nfunction isCacheValid() {\n    return cache !== null && Date.now() - cache.timestamp < CACHE_TTL_MS;\n}\n/** Invalidate cache manually (e.g., if the file is known to have changed) */ function invalidateExcelCache() {\n    cache = null;\n}\n// ─── Helper Functions ───────────────────────────────────────────────\nfunction excelDateToJS(serial) {\n    if (!serial || isNaN(serial)) return null;\n    const utc_days = Math.floor(serial - 25569);\n    const utc_value = utc_days * 86400;\n    return new Date(utc_value * 1000);\n}\nfunction formatExcelDate(serial) {\n    if (typeof serial === \"number\") {\n        const date = excelDateToJS(serial);\n        return date ? date.toLocaleDateString(\"pt-BR\") : \"-\";\n    }\n    return String(serial || \"-\");\n}\n// ─── Core Data Access ───────────────────────────────────────────────\nasync function readExcelData() {\n    if (isCacheValid()) {\n        return {\n            osData: cache.osData,\n            caixaData: cache.caixaData\n        };\n    }\n    const buffer = await (0,fs_promises__WEBPACK_IMPORTED_MODULE_0__.readFile)(EXCEL_PATH);\n    const workbook = xlsx__WEBPACK_IMPORTED_MODULE_1__.read(buffer, {\n        type: \"buffer\"\n    });\n    const osSheet = workbook.Sheets[\"Os\"];\n    const osData = osSheet ? xlsx__WEBPACK_IMPORTED_MODULE_1__.utils.sheet_to_json(osSheet) : [];\n    const caixaSheet = workbook.Sheets[\"CaixaAlares\"];\n    const caixaData = caixaSheet ? xlsx__WEBPACK_IMPORTED_MODULE_1__.utils.sheet_to_json(caixaSheet) : [];\n    // Update cache\n    cache = {\n        osData,\n        caixaData,\n        timestamp: Date.now()\n    };\n    return {\n        osData,\n        caixaData\n    };\n}\n// ─── Public API ─────────────────────────────────────────────────────\nasync function getExcelData() {\n    return readExcelData();\n}\nasync function getAllOS() {\n    const { osData, caixaData } = await readExcelData();\n    return osData.map((row)=>{\n        const osId = String(row.IdOs || row.ID || \"\");\n        const totalCaixas = caixaData.filter((c)=>String(c.OS) === osId).length;\n        return {\n            id: osId,\n            pop: String(row.POP || row.Pop || \"\"),\n            status: String(row.StatusOperacao || \"\").trim(),\n            uf: String(row.UF || \"\"),\n            dataEntrante: formatExcelDate(row[\"Entrante\"]),\n            dataPrevExec: formatExcelDate(row[\"Prev. Exec.\"]),\n            rawPrevExec: typeof row[\"Prev. Exec.\"] === \"number\" ? row[\"Prev. Exec.\"] : 0,\n            dataConclusao: formatExcelDate(row[\"Conclusao\"]),\n            rawConclusao: typeof row[\"Conclusao\"] === \"number\" ? row[\"Conclusao\"] : 0,\n            cenario: String(row.Cenario || \"\"),\n            protocolo: String(row.Protocolo || \"\"),\n            totalCaixas\n        };\n    }).filter((os)=>{\n        const s = os.status.toLowerCase();\n        return s === \"iniciar\" || s === \"em execu\\xe7\\xe3o\" || s === \"em execucao\" || s === \"pend. cliente\" || s === \"conclu\\xeddo\" || s === \"concluido\" || s === \"encerrada\" || s === \"cancelado\";\n    }).sort((a, b)=>a.rawPrevExec - b.rawPrevExec);\n}\nasync function getOSById(id) {\n    const { osData, caixaData } = await readExcelData();\n    const osRow = osData.find((row)=>String(row.IdOs || row.ID) === id || String(row.POP || row.Pop) === id);\n    if (!osRow) return null;\n    const osId = String(osRow.IdOs || osRow.ID);\n    const pop = String(osRow.POP || osRow.Pop);\n    const items = caixaData.filter((row)=>String(row.OS) === osId).map((row, index)=>{\n        const chassiPath = [\n            row.Pop || row.POP,\n            row.Chassi,\n            row.Placa,\n            row.OLT,\n            row.Cto\n        ].filter(Boolean).join(\"/\");\n        return {\n            id: String(row.IdCaixa || index),\n            cto: String(row.Cto || \"\"),\n            chassiPath,\n            endereco: String(row.Endereco || \"\"),\n            lat: row.Lat ? parseFloat(String(row.Lat)) : null,\n            long: row.Long ? parseFloat(String(row.Long)) : null,\n            status: String(row.Status || \"Pendente\"),\n            done: row.Status === \"OK\"\n        };\n    });\n    return {\n        id: String(osRow.IdOs || osRow.ID || pop),\n        pop,\n        status: String(osRow.StatusOperacao || \"\"),\n        protocolo: String(osRow.Protocolo || \"\"),\n        uf: String(osRow.UF || \"\"),\n        dataEntrante: formatExcelDate(osRow[\"Entrante\"]),\n        dataPrevExec: formatExcelDate(osRow[\"Prev. Exec.\"]),\n        rawPrevExec: typeof osRow[\"Prev. Exec.\"] === \"number\" ? osRow[\"Prev. Exec.\"] : 0,\n        dataConclusao: formatExcelDate(osRow[\"Conclusao\"]),\n        rawConclusao: typeof osRow[\"Conclusao\"] === \"number\" ? osRow[\"Conclusao\"] : 0,\n        cenario: String(osRow.Cenario || \"\"),\n        items\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFXQSxLQUFLLENBQUMsWUFBWSxHQUFHO1FBQzVFWCxTQUFTdkMsT0FBT2tELE1BQU1WLE9BQU8sSUFBSTtRQUNqQ1k7SUFDSjtBQUNKIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8veG9uLXNlcnZpY29zLy4vc3JjL2xpYi9leGNlbC50cz80N2NlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIFhMU1ggZnJvbSAneGxzeCc7XHJcbmltcG9ydCB7IHJlYWRGaWxlIH0gZnJvbSAnZnMvcHJvbWlzZXMnO1xyXG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgT1Mge1xyXG4gICAgaWQ6IHN0cmluZztcclxuICAgIHBvcDogc3RyaW5nO1xyXG4gICAgc3RhdHVzOiBzdHJpbmc7XHJcbiAgICB1Zjogc3RyaW5nO1xyXG4gICAgZGF0YUVudHJhbnRlOiBzdHJpbmc7XHJcbiAgICBkYXRhUHJldkV4ZWM6IHN0cmluZztcclxuICAgIHJhd1ByZXZFeGVjPzogbnVtYmVyO1xyXG4gICAgZGF0YUNvbmNsdXNhbz86IHN0cmluZztcclxuICAgIHJhd0NvbmNsdXNhbz86IG51bWJlcjtcclxuICAgIGNlbmFyaW86IHN0cmluZztcclxuICAgIHByb3RvY29sbzogc3RyaW5nO1xyXG4gICAgdG90YWxDYWl4YXM6IG51bWJlcjtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBDYWl4YUl0ZW0ge1xyXG4gICAgaWQ6IHN0cmluZztcclxuICAgIGN0bzogc3RyaW5nO1xyXG4gICAgY2hhc3NpUGF0aDogc3RyaW5nO1xyXG4gICAgZW5kZXJlY286IHN0cmluZztcclxuICAgIGxhdDogbnVtYmVyIHwgbnVsbDtcclxuICAgIGxvbmc6IG51bWJlciB8IG51bGw7XHJcbiAgICBzdGF0dXM6IHN0cmluZztcclxuICAgIGRvbmU6IGJvb2xlYW47XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBBTExPV0VEX1NUQVRVU0VTID0gWydpbmljaWFyJywgJ2VtIGV4ZWN1w6fDo28nLCAnZW0gZXhlY3VjYW8nLCAncGVuZC4gY2xpZW50ZScsICdjb25jbHXDrWRvJywgJ2NvbmNsdWlkbycsICdlbmNlcnJhZGEnLCAnY2FuY2VsYWRvJ107XHJcblxyXG5jb25zdCBFWENFTF9QQVRIID0gcHJvY2Vzcy5lbnYuRVhDRUxfUEFUSCB8fCAnQzpcXFxcUHJvZ3JhbWFzXFxcXFBST0pFVE9TXFxcXHBsYW5pbGhhXFxcXE9zLnhsc3gnO1xyXG5cclxuLy8g4pSA4pSA4pSAIEluLU1lbW9yeSBDYWNoZSB3aXRoIFRUTCDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIBcclxuY29uc3QgQ0FDSEVfVFRMX01TID0gNjAgKiAxMDAwOyAvLyA2MCBzZWNvbmRzXHJcblxyXG5pbnRlcmZhY2UgRXhjZWxDYWNoZSB7XHJcbiAgICBvc0RhdGE6IFJlY29yZDxzdHJpbmcsIGFueT5bXTtcclxuICAgIGNhaXhhRGF0YTogUmVjb3JkPHN0cmluZywgYW55PltdO1xyXG4gICAgdGltZXN0YW1wOiBudW1iZXI7XHJcbn1cclxuXHJcbmxldCBjYWNoZTogRXhjZWxDYWNoZSB8IG51bGwgPSBudWxsO1xyXG5cclxuZnVuY3Rpb24gaXNDYWNoZVZhbGlkKCk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIGNhY2hlICE9PSBudWxsICYmIChEYXRlLm5vdygpIC0gY2FjaGUudGltZXN0YW1wKSA8IENBQ0hFX1RUTF9NUztcclxufVxyXG5cclxuLyoqIEludmFsaWRhdGUgY2FjaGUgbWFudWFsbHkgKGUuZy4sIGlmIHRoZSBmaWxlIGlzIGtub3duIHRvIGhhdmUgY2hhbmdlZCkgKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGludmFsaWRhdGVFeGNlbENhY2hlKCkge1xyXG4gICAgY2FjaGUgPSBudWxsO1xyXG59XHJcblxyXG4vLyDilIDilIDilIAgSGVscGVyIEZ1bmN0aW9ucyDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIBcclxuZnVuY3Rpb24gZXhjZWxEYXRlVG9KUyhzZXJpYWw6IG51bWJlcik6IERhdGUgfCBudWxsIHtcclxuICAgIGlmICghc2VyaWFsIHx8IGlzTmFOKHNlcmlhbCkpIHJldHVybiBudWxsO1xyXG4gICAgY29uc3QgdXRjX2RheXMgPSBNYXRoLmZsb29yKHNlcmlhbCAtIDI1NTY5KTtcclxuICAgIGNvbnN0IHV0Y192YWx1ZSA9IHV0Y19kYXlzICogODY0MDA7XHJcbiAgICByZXR1cm4gbmV3IERhdGUodXRjX3ZhbHVlICogMTAwMCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGZvcm1hdEV4Y2VsRGF0ZShzZXJpYWw6IGFueSk6IHN0cmluZyB7XHJcbiAgICBpZiAodHlwZW9mIHNlcmlhbCA9PT0gJ251bWJlcicpIHtcclxuICAgICAgICBjb25zdCBkYXRlID0gZXhjZWxEYXRlVG9KUyhzZXJpYWwpO1xyXG4gICAgICAgIHJldHVybiBkYXRlID8gZGF0ZS50b0xvY2FsZURhdGVTdHJpbmcoJ3B0LUJSJykgOiAnLSc7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gU3RyaW5nKHNlcmlhbCB8fCAnLScpO1xyXG59XHJcblxyXG4vLyDilIDilIDilIAgQ29yZSBEYXRhIEFjY2VzcyDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIBcclxuYXN5bmMgZnVuY3Rpb24gcmVhZEV4Y2VsRGF0YSgpOiBQcm9taXNlPHsgb3NEYXRhOiBSZWNvcmQ8c3RyaW5nLCBhbnk+W107IGNhaXhhRGF0YTogUmVjb3JkPHN0cmluZywgYW55PltdIH0+IHtcclxuICAgIGlmIChpc0NhY2hlVmFsaWQoKSkge1xyXG4gICAgICAgIHJldHVybiB7IG9zRGF0YTogY2FjaGUhLm9zRGF0YSwgY2FpeGFEYXRhOiBjYWNoZSEuY2FpeGFEYXRhIH07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgYnVmZmVyID0gYXdhaXQgcmVhZEZpbGUoRVhDRUxfUEFUSCk7XHJcbiAgICBjb25zdCB3b3JrYm9vayA9IFhMU1gucmVhZChidWZmZXIsIHsgdHlwZTogJ2J1ZmZlcicgfSk7XHJcblxyXG4gICAgY29uc3Qgb3NTaGVldCA9IHdvcmtib29rLlNoZWV0c1snT3MnXTtcclxuICAgIGNvbnN0IG9zRGF0YTogUmVjb3JkPHN0cmluZywgYW55PltdID0gb3NTaGVldCA/IFhMU1gudXRpbHMuc2hlZXRfdG9fanNvbihvc1NoZWV0KSA6IFtdO1xyXG5cclxuICAgIGNvbnN0IGNhaXhhU2hlZXQgPSB3b3JrYm9vay5TaGVldHNbJ0NhaXhhQWxhcmVzJ107XHJcbiAgICBjb25zdCBjYWl4YURhdGE6IFJlY29yZDxzdHJpbmcsIGFueT5bXSA9IGNhaXhhU2hlZXQgPyBYTFNYLnV0aWxzLnNoZWV0X3RvX2pzb24oY2FpeGFTaGVldCkgOiBbXTtcclxuXHJcbiAgICAvLyBVcGRhdGUgY2FjaGVcclxuICAgIGNhY2hlID0geyBvc0RhdGEsIGNhaXhhRGF0YSwgdGltZXN0YW1wOiBEYXRlLm5vdygpIH07XHJcblxyXG4gICAgcmV0dXJuIHsgb3NEYXRhLCBjYWl4YURhdGEgfTtcclxufVxyXG5cclxuLy8g4pSA4pSA4pSAIFB1YmxpYyBBUEkg4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRFeGNlbERhdGEoKSB7XHJcbiAgICByZXR1cm4gcmVhZEV4Y2VsRGF0YSgpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWxsT1MoKTogUHJvbWlzZTxPU1tdPiB7XHJcbiAgICBjb25zdCB7IG9zRGF0YSwgY2FpeGFEYXRhIH0gPSBhd2FpdCByZWFkRXhjZWxEYXRhKCk7XHJcblxyXG4gICAgcmV0dXJuIG9zRGF0YVxyXG4gICAgICAgIC5tYXAoKHJvdykgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBvc0lkID0gU3RyaW5nKHJvdy5JZE9zIHx8IHJvdy5JRCB8fCAnJyk7XHJcbiAgICAgICAgICAgIGNvbnN0IHRvdGFsQ2FpeGFzID0gY2FpeGFEYXRhLmZpbHRlcigoYykgPT4gU3RyaW5nKGMuT1MpID09PSBvc0lkKS5sZW5ndGg7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgaWQ6IG9zSWQsXHJcbiAgICAgICAgICAgICAgICBwb3A6IFN0cmluZyhyb3cuUE9QIHx8IHJvdy5Qb3AgfHwgJycpLFxyXG4gICAgICAgICAgICAgICAgc3RhdHVzOiBTdHJpbmcocm93LlN0YXR1c09wZXJhY2FvIHx8ICcnKS50cmltKCksXHJcbiAgICAgICAgICAgICAgICB1ZjogU3RyaW5nKHJvdy5VRiB8fCAnJyksXHJcbiAgICAgICAgICAgICAgICBkYXRhRW50cmFudGU6IGZvcm1hdEV4Y2VsRGF0ZShyb3dbJ0VudHJhbnRlJ10pLFxyXG4gICAgICAgICAgICAgICAgZGF0YVByZXZFeGVjOiBmb3JtYXRFeGNlbERhdGUocm93WydQcmV2LiBFeGVjLiddKSxcclxuICAgICAgICAgICAgICAgIHJhd1ByZXZFeGVjOiB0eXBlb2Ygcm93WydQcmV2LiBFeGVjLiddID09PSAnbnVtYmVyJyA/IHJvd1snUHJldi4gRXhlYy4nXSA6IDAsXHJcbiAgICAgICAgICAgICAgICBkYXRhQ29uY2x1c2FvOiBmb3JtYXRFeGNlbERhdGUocm93WydDb25jbHVzYW8nXSksXHJcbiAgICAgICAgICAgICAgICByYXdDb25jbHVzYW86IHR5cGVvZiByb3dbJ0NvbmNsdXNhbyddID09PSAnbnVtYmVyJyA/IHJvd1snQ29uY2x1c2FvJ10gOiAwLFxyXG4gICAgICAgICAgICAgICAgY2VuYXJpbzogU3RyaW5nKHJvdy5DZW5hcmlvIHx8ICcnKSxcclxuICAgICAgICAgICAgICAgIHByb3RvY29sbzogU3RyaW5nKHJvdy5Qcm90b2NvbG8gfHwgJycpLFxyXG4gICAgICAgICAgICAgICAgdG90YWxDYWl4YXNcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5maWx0ZXIoKG9zKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHMgPSBvcy5zdGF0dXMudG9Mb3dlckNhc2UoKTtcclxuICAgICAgICAgICAgcmV0dXJuIHMgPT09ICdpbmljaWFyJyB8fCBzID09PSAnZW0gZXhlY3XDp8OjbycgfHwgcyA9PT0gJ2VtIGV4ZWN1Y2FvJ1xyXG4gICAgICAgICAgICAgICAgfHwgcyA9PT0gJ3BlbmQuIGNsaWVudGUnIHx8IHMgPT09ICdjb25jbHXDrWRvJyB8fCBzID09PSAnY29uY2x1aWRvJ1xyXG4gICAgICAgICAgICAgICAgfHwgcyA9PT0gJ2VuY2VycmFkYScgfHwgcyA9PT0gJ2NhbmNlbGFkbyc7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuc29ydCgoYSwgYikgPT4gYS5yYXdQcmV2RXhlYyAtIGIucmF3UHJldkV4ZWMpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0T1NCeUlkKGlkOiBzdHJpbmcpIHtcclxuICAgIGNvbnN0IHsgb3NEYXRhLCBjYWl4YURhdGEgfSA9IGF3YWl0IHJlYWRFeGNlbERhdGEoKTtcclxuXHJcbiAgICBjb25zdCBvc1JvdyA9IG9zRGF0YS5maW5kKChyb3cpID0+IFN0cmluZyhyb3cuSWRPcyB8fCByb3cuSUQpID09PSBpZCB8fCBTdHJpbmcocm93LlBPUCB8fCByb3cuUG9wKSA9PT0gaWQpO1xyXG5cclxuICAgIGlmICghb3NSb3cpIHJldHVybiBudWxsO1xyXG5cclxuICAgIGNvbnN0IG9zSWQgPSBTdHJpbmcob3NSb3cuSWRPcyB8fCBvc1Jvdy5JRCk7XHJcbiAgICBjb25zdCBwb3AgPSBTdHJpbmcob3NSb3cuUE9QIHx8IG9zUm93LlBvcCk7XHJcblxyXG4gICAgY29uc3QgaXRlbXM6IENhaXhhSXRlbVtdID0gY2FpeGFEYXRhXHJcbiAgICAgICAgLmZpbHRlcigocm93KSA9PiBTdHJpbmcocm93Lk9TKSA9PT0gb3NJZClcclxuICAgICAgICAubWFwKChyb3csIGluZGV4KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNoYXNzaVBhdGggPSBbXHJcbiAgICAgICAgICAgICAgICByb3cuUG9wIHx8IHJvdy5QT1AsXHJcbiAgICAgICAgICAgICAgICByb3cuQ2hhc3NpLFxyXG4gICAgICAgICAgICAgICAgcm93LlBsYWNhLFxyXG4gICAgICAgICAgICAgICAgcm93Lk9MVCxcclxuICAgICAgICAgICAgICAgIHJvdy5DdG9cclxuICAgICAgICAgICAgXS5maWx0ZXIoQm9vbGVhbikuam9pbignLycpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIGlkOiBTdHJpbmcocm93LklkQ2FpeGEgfHwgaW5kZXgpLFxyXG4gICAgICAgICAgICAgICAgY3RvOiBTdHJpbmcocm93LkN0byB8fCAnJyksXHJcbiAgICAgICAgICAgICAgICBjaGFzc2lQYXRoLFxyXG4gICAgICAgICAgICAgICAgZW5kZXJlY286IFN0cmluZyhyb3cuRW5kZXJlY28gfHwgJycpLFxyXG4gICAgICAgICAgICAgICAgbGF0OiByb3cuTGF0ID8gcGFyc2VGbG9hdChTdHJpbmcocm93LkxhdCkpIDogbnVsbCxcclxuICAgICAgICAgICAgICAgIGxvbmc6IHJvdy5Mb25nID8gcGFyc2VGbG9hdChTdHJpbmcocm93LkxvbmcpKSA6IG51bGwsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IFN0cmluZyhyb3cuU3RhdHVzIHx8ICdQZW5kZW50ZScpLFxyXG4gICAgICAgICAgICAgICAgZG9uZTogcm93LlN0YXR1cyA9PT0gJ09LJ1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgaWQ6IFN0cmluZyhvc1Jvdy5JZE9zIHx8IG9zUm93LklEIHx8IHBvcCksXHJcbiAgICAgICAgcG9wLFxyXG4gICAgICAgIHN0YXR1czogU3RyaW5nKG9zUm93LlN0YXR1c09wZXJhY2FvIHx8ICcnKSxcclxuICAgICAgICBwcm90b2NvbG86IFN0cmluZyhvc1Jvdy5Qcm90b2NvbG8gfHwgJycpLFxyXG4gICAgICAgIHVmOiBTdHJpbmcob3NSb3cuVUYgfHwgJycpLFxyXG4gICAgICAgIGRhdGFFbnRyYW50ZTogZm9ybWF0RXhjZWxEYXRlKG9zUm93WydFbnRyYW50ZSddKSxcclxuICAgICAgICBkYXRhUHJldkV4ZWM6IGZvcm1hdEV4Y2VsRGF0ZShvc1Jvd1snUHJldi4gRXhlYy4nXSksXHJcbiAgICAgICAgcmF3UHJldkV4ZWM6IHR5cGVvZiBvc1Jvd1snUHJldi4gRXhlYy4nXSA9PT0gJ251bWJlcicgPyBvc1Jvd1snUHJldi4gRXhlYy4nXSA6IDAsXHJcbiAgICAgICAgZGF0YUNvbmNsdXNhbzogZm9ybWF0RXhjZWxEYXRlKG9zUm93WydDb25jbHVzYW8nXSksXHJcbiAgICAgICAgcmF3Q29uY2x1c2FvOiB0eXBlb2Ygb3NSb3dbJ0NvbmNsdXNhbyddID09PSAnbnVtYmVyJyA/IG9zUm93WydDb25jbHVzYW8nXSA6IDAsXHJcbiAgICAgICAgY2VuYXJpbzogU3RyaW5nKG9zUm93LkNlbmFyaW8gfHwgJycpLFxyXG4gICAgICAgIGl0ZW1zXHJcbiAgICB9O1xyXG59XHJcbiJdLCJuYW1lcyI6WyJYTFNYIiwicmVhZEZpbGUiLCJBTExPV0VEX1NUQVRVU0VTIiwiRVhDRUxfUEFUSCIsInByb2Nlc3MiLCJlbnYiLCJDQUNIRV9UVExfTVMiLCJjYWNoZSIsImlzQ2FjaGVWYWxpZCIsIkRhdGUiLCJub3ciLCJ0aW1lc3RhbXAiLCJpbnZhbGlkYXRlRXhjZWxDYWNoZSIsImV4Y2VsRGF0ZVRvSlMiLCJzZXJpYWwiLCJpc05hTiIsInV0Y19kYXlzIiwiTWF0aCIsImZsb29yIiwidXRjX3ZhbHVlIiwiZm9ybWF0RXhjZWxEYXRlIiwiZGF0ZSIsInRvTG9jYWxlRGF0ZVN0cmluZyIsIlN0cmluZyIsInJlYWRFeGNlbERhdGEiLCJvc0RhdGEiLCJjYWl4YURhdGEiLCJidWZmZXIiLCJ3b3JrYm9vayIsInJlYWQiLCJ0eXBlIiwib3NTaGVldCIsIlNoZWV0cyIsInV0aWxzIiwic2hlZXRfdG9fanNvbiIsImNhaXhhU2hlZXQiLCJnZXRFeGNlbERhdGEiLCJnZXRBbGxPUyIsIm1hcCIsInJvdyIsIm9zSWQiLCJJZE9zIiwiSUQiLCJ0b3RhbENhaXhhcyIsImZpbHRlciIsImMiLCJPUyIsImxlbmd0aCIsImlkIiwicG9wIiwiUE9QIiwiUG9wIiwic3RhdHVzIiwiU3RhdHVzT3BlcmFjYW8iLCJ0cmltIiwidWYiLCJVRiIsImRhdGFFbnRyYW50ZSIsImRhdGFQcmV2RXhlYyIsInJhd1ByZXZFeGVjIiwiZGF0YUNvbmNsdXNhbyIsInJhd0NvbmNsdXNhbyIsImNlbmFyaW8iLCJDZW5hcmlvIiwicHJvdG9jb2xvIiwiUHJvdG9jb2xvIiwib3MiLCJzIiwidG9Mb3dlckNhc2UiLCJzb3J0IiwiYSIsImIiLCJnZXRPU0J5SWQiLCJvc1JvdyIsImZpbmQiLCJpdGVtcyIsImluZGV4IiwiY2hhc3NpUGF0aCIsIkNoYXNzaSIsIlBsYWNhIiwiT0xUIiwiQ3RvIiwiQm9vbGVhbiIsImpvaW4iLCJJZENhaXhhIiwiY3RvIiwiZW5kZXJlY28iLCJFbmRlcmVjbyIsImxhdCIsIkxhdCIsInBhcnNlRmxvYXQiLCJsb25nIiwiTG9uZyIsIlN0YXR1cyIsImRvbmUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(action-browser)/./src/lib/excel.ts\n");

/***/ })

};
;