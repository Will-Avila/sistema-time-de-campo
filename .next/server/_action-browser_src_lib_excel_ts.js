"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "_action-browser_src_lib_excel_ts";
exports.ids = ["_action-browser_src_lib_excel_ts"];
exports.modules = {

/***/ "(action-browser)/./src/lib/excel.ts":
/*!**************************!*\
  !*** ./src/lib/excel.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getAllOS: () => (/* binding */ getAllOS),\n/* harmony export */   getExcelData: () => (/* binding */ getExcelData),\n/* harmony export */   getOSById: () => (/* binding */ getOSById),\n/* harmony export */   invalidateExcelCache: () => (/* binding */ invalidateExcelCache)\n/* harmony export */ });\n/* harmony import */ var xlsx__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! xlsx */ \"(action-browser)/./node_modules/xlsx/xlsx.mjs\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs/promises */ \"fs/promises\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs_promises__WEBPACK_IMPORTED_MODULE_0__);\n\n\nconst EXCEL_PATH = process.env.EXCEL_PATH || \"C:\\\\Programas\\\\PROJETOS\\\\planilha\\\\Os.xlsx\";\n// ─── In-Memory Cache with TTL ───────────────────────────────────────\nconst CACHE_TTL_MS = 60 * 1000; // 60 seconds\nlet cache = null;\nfunction isCacheValid() {\n    return cache !== null && Date.now() - cache.timestamp < CACHE_TTL_MS;\n}\n/** Invalidate cache manually (e.g., if the file is known to have changed) */ function invalidateExcelCache() {\n    cache = null;\n}\n// ─── Helper Functions ───────────────────────────────────────────────\nfunction excelDateToJS(serial) {\n    if (!serial || isNaN(serial)) return null;\n    const utc_days = Math.floor(serial - 25569);\n    const utc_value = utc_days * 86400;\n    return new Date(utc_value * 1000);\n}\nfunction formatExcelDate(serial) {\n    if (typeof serial === \"number\") {\n        const date = excelDateToJS(serial);\n        return date ? date.toLocaleDateString(\"pt-BR\") : \"-\";\n    }\n    return String(serial || \"-\");\n}\n// ─── Core Data Access ───────────────────────────────────────────────\nasync function readExcelData() {\n    if (isCacheValid()) {\n        return {\n            osData: cache.osData,\n            caixaData: cache.caixaData\n        };\n    }\n    const buffer = await (0,fs_promises__WEBPACK_IMPORTED_MODULE_0__.readFile)(EXCEL_PATH);\n    const workbook = xlsx__WEBPACK_IMPORTED_MODULE_1__.read(buffer, {\n        type: \"buffer\"\n    });\n    const osSheet = workbook.Sheets[\"Os\"];\n    const osData = osSheet ? xlsx__WEBPACK_IMPORTED_MODULE_1__.utils.sheet_to_json(osSheet) : [];\n    const caixaSheet = workbook.Sheets[\"CaixaAlares\"];\n    const caixaData = caixaSheet ? xlsx__WEBPACK_IMPORTED_MODULE_1__.utils.sheet_to_json(caixaSheet) : [];\n    // Update cache\n    cache = {\n        osData,\n        caixaData,\n        timestamp: Date.now()\n    };\n    return {\n        osData,\n        caixaData\n    };\n}\n// ─── Public API ─────────────────────────────────────────────────────\nasync function getExcelData() {\n    return readExcelData();\n}\nasync function getAllOS() {\n    const { osData, caixaData } = await readExcelData();\n    return osData.map((row)=>{\n        const osId = String(row.IdOs || row.ID || \"\");\n        const totalCaixas = caixaData.filter((c)=>String(c.OS) === osId).length;\n        return {\n            id: osId,\n            pop: String(row.POP || row.Pop || \"\"),\n            status: String(row.StatusOperacao || \"\").trim(),\n            uf: String(row.UF || \"\"),\n            dataEntrante: formatExcelDate(row[\"Entrante\"]),\n            dataPrevExec: formatExcelDate(row[\"Prev. Exec.\"]),\n            rawPrevExec: typeof row[\"Prev. Exec.\"] === \"number\" ? row[\"Prev. Exec.\"] : 0,\n            cenario: String(row.Cenario || \"\"),\n            protocolo: String(row.Protocolo || \"\"),\n            totalCaixas\n        };\n    }).filter((os)=>{\n        const statusLower = os.status.toLowerCase();\n        return statusLower === \"iniciar\" || statusLower === \"em execu\\xe7\\xe3o\" || statusLower === \"em execucao\";\n    }).sort((a, b)=>a.rawPrevExec - b.rawPrevExec);\n}\nasync function getOSById(id) {\n    const { osData, caixaData } = await readExcelData();\n    const osRow = osData.find((row)=>String(row.IdOs || row.ID) === id || String(row.POP || row.Pop) === id);\n    if (!osRow) return null;\n    const osId = String(osRow.IdOs || osRow.ID);\n    const pop = String(osRow.POP || osRow.Pop);\n    const items = caixaData.filter((row)=>String(row.OS) === osId).map((row, index)=>{\n        const chassiPath = [\n            row.Pop || row.POP,\n            row.Chassi,\n            row.Placa,\n            row.OLT,\n            row.Cto\n        ].filter(Boolean).join(\"/\");\n        return {\n            id: String(row.IdCaixa || index),\n            cto: String(row.Cto || \"\"),\n            chassiPath,\n            endereco: String(row.Endereco || \"\"),\n            lat: row.Lat ? parseFloat(String(row.Lat)) : null,\n            long: row.Long ? parseFloat(String(row.Long)) : null,\n            status: String(row.Status || \"Pendente\"),\n            done: row.Status === \"OK\"\n        };\n    });\n    return {\n        id: String(osRow.IdOs || osRow.ID || pop),\n        pop,\n        status: String(osRow.StatusOperacao || \"\"),\n        protocolo: String(osRow.Protocolo || \"\"),\n        items\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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d0MsR0FBRyxJQUFJO1lBQ3ZCSjtZQUNBUyxVQUFVN0QsT0FBT2dCLElBQUk4QyxRQUFRLElBQUk7WUFDakNDLEtBQUsvQyxJQUFJZ0QsR0FBRyxHQUFHQyxXQUFXakUsT0FBT2dCLElBQUlnRCxHQUFHLEtBQUs7WUFDN0NFLE1BQU1sRCxJQUFJbUQsSUFBSSxHQUFHRixXQUFXakUsT0FBT2dCLElBQUltRCxJQUFJLEtBQUs7WUFDaER0QyxRQUFRN0IsT0FBT2dCLElBQUlvRCxNQUFNLElBQUk7WUFDN0JDLE1BQU1yRCxJQUFJb0QsTUFBTSxLQUFLO1FBQ3pCO0lBQ0o7SUFFSixPQUFPO1FBQ0gzQyxJQUFJekIsT0FBT2dELE1BQU05QixJQUFJLElBQUk4QixNQUFNN0IsRUFBRSxJQUFJTztRQUNyQ0E7UUFDQUcsUUFBUTdCLE9BQU9nRCxNQUFNbEIsY0FBYyxJQUFJO1FBQ3ZDUyxXQUFXdkMsT0FBT2dELE1BQU1SLFNBQVMsSUFBSTtRQUNyQ1U7SUFDSjtBQUNKIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8veG9uLXNlcnZpY29zLy4vc3JjL2xpYi9leGNlbC50cz80N2NlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIFhMU1ggZnJvbSAneGxzeCc7XHJcbmltcG9ydCB7IHJlYWRGaWxlIH0gZnJvbSAnZnMvcHJvbWlzZXMnO1xyXG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgT1Mge1xyXG4gICAgaWQ6IHN0cmluZztcclxuICAgIHBvcDogc3RyaW5nO1xyXG4gICAgc3RhdHVzOiBzdHJpbmc7XHJcbiAgICB1Zjogc3RyaW5nO1xyXG4gICAgZGF0YUVudHJhbnRlOiBzdHJpbmc7XHJcbiAgICBkYXRhUHJldkV4ZWM6IHN0cmluZztcclxuICAgIHJhd1ByZXZFeGVjPzogbnVtYmVyO1xyXG4gICAgY2VuYXJpbzogc3RyaW5nO1xyXG4gICAgcHJvdG9jb2xvOiBzdHJpbmc7XHJcbiAgICB0b3RhbENhaXhhczogbnVtYmVyO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIENhaXhhSXRlbSB7XHJcbiAgICBpZDogc3RyaW5nO1xyXG4gICAgY3RvOiBzdHJpbmc7XHJcbiAgICBjaGFzc2lQYXRoOiBzdHJpbmc7XHJcbiAgICBlbmRlcmVjbzogc3RyaW5nO1xyXG4gICAgbGF0OiBudW1iZXIgfCBudWxsO1xyXG4gICAgbG9uZzogbnVtYmVyIHwgbnVsbDtcclxuICAgIHN0YXR1czogc3RyaW5nO1xyXG4gICAgZG9uZTogYm9vbGVhbjtcclxufVxyXG5cclxuY29uc3QgRVhDRUxfUEFUSCA9IHByb2Nlc3MuZW52LkVYQ0VMX1BBVEggfHwgJ0M6XFxcXFByb2dyYW1hc1xcXFxQUk9KRVRPU1xcXFxwbGFuaWxoYVxcXFxPcy54bHN4JztcclxuXHJcbi8vIOKUgOKUgOKUgCBJbi1NZW1vcnkgQ2FjaGUgd2l0aCBUVEwg4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAXHJcbmNvbnN0IENBQ0hFX1RUTF9NUyA9IDYwICogMTAwMDsgLy8gNjAgc2Vjb25kc1xyXG5cclxuaW50ZXJmYWNlIEV4Y2VsQ2FjaGUge1xyXG4gICAgb3NEYXRhOiBSZWNvcmQ8c3RyaW5nLCBhbnk+W107XHJcbiAgICBjYWl4YURhdGE6IFJlY29yZDxzdHJpbmcsIGFueT5bXTtcclxuICAgIHRpbWVzdGFtcDogbnVtYmVyO1xyXG59XHJcblxyXG5sZXQgY2FjaGU6IEV4Y2VsQ2FjaGUgfCBudWxsID0gbnVsbDtcclxuXHJcbmZ1bmN0aW9uIGlzQ2FjaGVWYWxpZCgpOiBib29sZWFuIHtcclxuICAgIHJldHVybiBjYWNoZSAhPT0gbnVsbCAmJiAoRGF0ZS5ub3coKSAtIGNhY2hlLnRpbWVzdGFtcCkgPCBDQUNIRV9UVExfTVM7XHJcbn1cclxuXHJcbi8qKiBJbnZhbGlkYXRlIGNhY2hlIG1hbnVhbGx5IChlLmcuLCBpZiB0aGUgZmlsZSBpcyBrbm93biB0byBoYXZlIGNoYW5nZWQpICovXHJcbmV4cG9ydCBmdW5jdGlvbiBpbnZhbGlkYXRlRXhjZWxDYWNoZSgpIHtcclxuICAgIGNhY2hlID0gbnVsbDtcclxufVxyXG5cclxuLy8g4pSA4pSA4pSAIEhlbHBlciBGdW5jdGlvbnMg4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAXHJcbmZ1bmN0aW9uIGV4Y2VsRGF0ZVRvSlMoc2VyaWFsOiBudW1iZXIpOiBEYXRlIHwgbnVsbCB7XHJcbiAgICBpZiAoIXNlcmlhbCB8fCBpc05hTihzZXJpYWwpKSByZXR1cm4gbnVsbDtcclxuICAgIGNvbnN0IHV0Y19kYXlzID0gTWF0aC5mbG9vcihzZXJpYWwgLSAyNTU2OSk7XHJcbiAgICBjb25zdCB1dGNfdmFsdWUgPSB1dGNfZGF5cyAqIDg2NDAwO1xyXG4gICAgcmV0dXJuIG5ldyBEYXRlKHV0Y192YWx1ZSAqIDEwMDApO1xyXG59XHJcblxyXG5mdW5jdGlvbiBmb3JtYXRFeGNlbERhdGUoc2VyaWFsOiBhbnkpOiBzdHJpbmcge1xyXG4gICAgaWYgKHR5cGVvZiBzZXJpYWwgPT09ICdudW1iZXInKSB7XHJcbiAgICAgICAgY29uc3QgZGF0ZSA9IGV4Y2VsRGF0ZVRvSlMoc2VyaWFsKTtcclxuICAgICAgICByZXR1cm4gZGF0ZSA/IGRhdGUudG9Mb2NhbGVEYXRlU3RyaW5nKCdwdC1CUicpIDogJy0nO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFN0cmluZyhzZXJpYWwgfHwgJy0nKTtcclxufVxyXG5cclxuLy8g4pSA4pSA4pSAIENvcmUgRGF0YSBBY2Nlc3Mg4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAXHJcbmFzeW5jIGZ1bmN0aW9uIHJlYWRFeGNlbERhdGEoKTogUHJvbWlzZTx7IG9zRGF0YTogUmVjb3JkPHN0cmluZywgYW55PltdOyBjYWl4YURhdGE6IFJlY29yZDxzdHJpbmcsIGFueT5bXSB9PiB7XHJcbiAgICBpZiAoaXNDYWNoZVZhbGlkKCkpIHtcclxuICAgICAgICByZXR1cm4geyBvc0RhdGE6IGNhY2hlIS5vc0RhdGEsIGNhaXhhRGF0YTogY2FjaGUhLmNhaXhhRGF0YSB9O1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGJ1ZmZlciA9IGF3YWl0IHJlYWRGaWxlKEVYQ0VMX1BBVEgpO1xyXG4gICAgY29uc3Qgd29ya2Jvb2sgPSBYTFNYLnJlYWQoYnVmZmVyLCB7IHR5cGU6ICdidWZmZXInIH0pO1xyXG5cclxuICAgIGNvbnN0IG9zU2hlZXQgPSB3b3JrYm9vay5TaGVldHNbJ09zJ107XHJcbiAgICBjb25zdCBvc0RhdGE6IFJlY29yZDxzdHJpbmcsIGFueT5bXSA9IG9zU2hlZXQgPyBYTFNYLnV0aWxzLnNoZWV0X3RvX2pzb24ob3NTaGVldCkgOiBbXTtcclxuXHJcbiAgICBjb25zdCBjYWl4YVNoZWV0ID0gd29ya2Jvb2suU2hlZXRzWydDYWl4YUFsYXJlcyddO1xyXG4gICAgY29uc3QgY2FpeGFEYXRhOiBSZWNvcmQ8c3RyaW5nLCBhbnk+W10gPSBjYWl4YVNoZWV0ID8gWExTWC51dGlscy5zaGVldF90b19qc29uKGNhaXhhU2hlZXQpIDogW107XHJcblxyXG4gICAgLy8gVXBkYXRlIGNhY2hlXHJcbiAgICBjYWNoZSA9IHsgb3NEYXRhLCBjYWl4YURhdGEsIHRpbWVzdGFtcDogRGF0ZS5ub3coKSB9O1xyXG5cclxuICAgIHJldHVybiB7IG9zRGF0YSwgY2FpeGFEYXRhIH07XHJcbn1cclxuXHJcbi8vIOKUgOKUgOKUgCBQdWJsaWMgQVBJIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgFxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RXhjZWxEYXRhKCkge1xyXG4gICAgcmV0dXJuIHJlYWRFeGNlbERhdGEoKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFsbE9TKCk6IFByb21pc2U8T1NbXT4ge1xyXG4gICAgY29uc3QgeyBvc0RhdGEsIGNhaXhhRGF0YSB9ID0gYXdhaXQgcmVhZEV4Y2VsRGF0YSgpO1xyXG5cclxuICAgIHJldHVybiBvc0RhdGFcclxuICAgICAgICAubWFwKChyb3cpID0+IHtcclxuICAgICAgICAgICAgY29uc3Qgb3NJZCA9IFN0cmluZyhyb3cuSWRPcyB8fCByb3cuSUQgfHwgJycpO1xyXG4gICAgICAgICAgICBjb25zdCB0b3RhbENhaXhhcyA9IGNhaXhhRGF0YS5maWx0ZXIoKGMpID0+IFN0cmluZyhjLk9TKSA9PT0gb3NJZCkubGVuZ3RoO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIGlkOiBvc0lkLFxyXG4gICAgICAgICAgICAgICAgcG9wOiBTdHJpbmcocm93LlBPUCB8fCByb3cuUG9wIHx8ICcnKSxcclxuICAgICAgICAgICAgICAgIHN0YXR1czogU3RyaW5nKHJvdy5TdGF0dXNPcGVyYWNhbyB8fCAnJykudHJpbSgpLFxyXG4gICAgICAgICAgICAgICAgdWY6IFN0cmluZyhyb3cuVUYgfHwgJycpLFxyXG4gICAgICAgICAgICAgICAgZGF0YUVudHJhbnRlOiBmb3JtYXRFeGNlbERhdGUocm93WydFbnRyYW50ZSddKSxcclxuICAgICAgICAgICAgICAgIGRhdGFQcmV2RXhlYzogZm9ybWF0RXhjZWxEYXRlKHJvd1snUHJldi4gRXhlYy4nXSksXHJcbiAgICAgICAgICAgICAgICByYXdQcmV2RXhlYzogdHlwZW9mIHJvd1snUHJldi4gRXhlYy4nXSA9PT0gJ251bWJlcicgPyByb3dbJ1ByZXYuIEV4ZWMuJ10gOiAwLFxyXG4gICAgICAgICAgICAgICAgY2VuYXJpbzogU3RyaW5nKHJvdy5DZW5hcmlvIHx8ICcnKSxcclxuICAgICAgICAgICAgICAgIHByb3RvY29sbzogU3RyaW5nKHJvdy5Qcm90b2NvbG8gfHwgJycpLFxyXG4gICAgICAgICAgICAgICAgdG90YWxDYWl4YXNcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5maWx0ZXIoKG9zKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHN0YXR1c0xvd2VyID0gb3Muc3RhdHVzLnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgICAgIHJldHVybiAoc3RhdHVzTG93ZXIgPT09ICdpbmljaWFyJyB8fCBzdGF0dXNMb3dlciA9PT0gJ2VtIGV4ZWN1w6fDo28nIHx8IHN0YXR1c0xvd2VyID09PSAnZW0gZXhlY3VjYW8nKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5zb3J0KChhLCBiKSA9PiBhLnJhd1ByZXZFeGVjIC0gYi5yYXdQcmV2RXhlYyk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRPU0J5SWQoaWQ6IHN0cmluZykge1xyXG4gICAgY29uc3QgeyBvc0RhdGEsIGNhaXhhRGF0YSB9ID0gYXdhaXQgcmVhZEV4Y2VsRGF0YSgpO1xyXG5cclxuICAgIGNvbnN0IG9zUm93ID0gb3NEYXRhLmZpbmQoKHJvdykgPT4gU3RyaW5nKHJvdy5JZE9zIHx8IHJvdy5JRCkgPT09IGlkIHx8IFN0cmluZyhyb3cuUE9QIHx8IHJvdy5Qb3ApID09PSBpZCk7XHJcblxyXG4gICAgaWYgKCFvc1JvdykgcmV0dXJuIG51bGw7XHJcblxyXG4gICAgY29uc3Qgb3NJZCA9IFN0cmluZyhvc1Jvdy5JZE9zIHx8IG9zUm93LklEKTtcclxuICAgIGNvbnN0IHBvcCA9IFN0cmluZyhvc1Jvdy5QT1AgfHwgb3NSb3cuUG9wKTtcclxuXHJcbiAgICBjb25zdCBpdGVtczogQ2FpeGFJdGVtW10gPSBjYWl4YURhdGFcclxuICAgICAgICAuZmlsdGVyKChyb3cpID0+IFN0cmluZyhyb3cuT1MpID09PSBvc0lkKVxyXG4gICAgICAgIC5tYXAoKHJvdywgaW5kZXgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY2hhc3NpUGF0aCA9IFtcclxuICAgICAgICAgICAgICAgIHJvdy5Qb3AgfHwgcm93LlBPUCxcclxuICAgICAgICAgICAgICAgIHJvdy5DaGFzc2ksXHJcbiAgICAgICAgICAgICAgICByb3cuUGxhY2EsXHJcbiAgICAgICAgICAgICAgICByb3cuT0xULFxyXG4gICAgICAgICAgICAgICAgcm93LkN0b1xyXG4gICAgICAgICAgICBdLmZpbHRlcihCb29sZWFuKS5qb2luKCcvJyk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgaWQ6IFN0cmluZyhyb3cuSWRDYWl4YSB8fCBpbmRleCksXHJcbiAgICAgICAgICAgICAgICBjdG86IFN0cmluZyhyb3cuQ3RvIHx8ICcnKSxcclxuICAgICAgICAgICAgICAgIGNoYXNzaVBhdGgsXHJcbiAgICAgICAgICAgICAgICBlbmRlcmVjbzogU3RyaW5nKHJvdy5FbmRlcmVjbyB8fCAnJyksXHJcbiAgICAgICAgICAgICAgICBsYXQ6IHJvdy5MYXQgPyBwYXJzZUZsb2F0KFN0cmluZyhyb3cuTGF0KSkgOiBudWxsLFxyXG4gICAgICAgICAgICAgICAgbG9uZzogcm93LkxvbmcgPyBwYXJzZUZsb2F0KFN0cmluZyhyb3cuTG9uZykpIDogbnVsbCxcclxuICAgICAgICAgICAgICAgIHN0YXR1czogU3RyaW5nKHJvdy5TdGF0dXMgfHwgJ1BlbmRlbnRlJyksXHJcbiAgICAgICAgICAgICAgICBkb25lOiByb3cuU3RhdHVzID09PSAnT0snXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBpZDogU3RyaW5nKG9zUm93LklkT3MgfHwgb3NSb3cuSUQgfHwgcG9wKSxcclxuICAgICAgICBwb3AsXHJcbiAgICAgICAgc3RhdHVzOiBTdHJpbmcob3NSb3cuU3RhdHVzT3BlcmFjYW8gfHwgJycpLFxyXG4gICAgICAgIHByb3RvY29sbzogU3RyaW5nKG9zUm93LlByb3RvY29sbyB8fCAnJyksXHJcbiAgICAgICAgaXRlbXNcclxuICAgIH07XHJcbn1cclxuIl0sIm5hbWVzIjpbIlhMU1giLCJyZWFkRmlsZSIsIkVYQ0VMX1BBVEgiLCJwcm9jZXNzIiwiZW52IiwiQ0FDSEVfVFRMX01TIiwiY2FjaGUiLCJpc0NhY2hlVmFsaWQiLCJEYXRlIiwibm93IiwidGltZXN0YW1wIiwiaW52YWxpZGF0ZUV4Y2VsQ2FjaGUiLCJleGNlbERhdGVUb0pTIiwic2VyaWFsIiwiaXNOYU4iLCJ1dGNfZGF5cyIsIk1hdGgiLCJmbG9vciIsInV0Y192YWx1ZSIsImZvcm1hdEV4Y2VsRGF0ZSIsImRhdGUiLCJ0b0xvY2FsZURhdGVTdHJpbmciLCJTdHJpbmciLCJyZWFkRXhjZWxEYXRhIiwib3NEYXRhIiwiY2FpeGFEYXRhIiwiYnVmZmVyIiwid29ya2Jvb2siLCJyZWFkIiwidHlwZSIsIm9zU2hlZXQiLCJTaGVldHMiLCJ1dGlscyIsInNoZWV0X3RvX2pzb24iLCJjYWl4YVNoZWV0IiwiZ2V0RXhjZWxEYXRhIiwiZ2V0QWxsT1MiLCJtYXAiLCJyb3ciLCJvc0lkIiwiSWRPcyIsIklEIiwidG90YWxDYWl4YXMiLCJmaWx0ZXIiLCJjIiwiT1MiLCJsZW5ndGgiLCJpZCIsInBvcCIsIlBPUCIsIlBvcCIsInN0YXR1cyIsIlN0YXR1c09wZXJhY2FvIiwidHJpbSIsInVmIiwiVUYiLCJkYXRhRW50cmFudGUiLCJkYXRhUHJldkV4ZWMiLCJyYXdQcmV2RXhlYyIsImNlbmFyaW8iLCJDZW5hcmlvIiwicHJvdG9jb2xvIiwiUHJvdG9jb2xvIiwib3MiLCJzdGF0dXNMb3dlciIsInRvTG93ZXJDYXNlIiwic29ydCIsImEiLCJiIiwiZ2V0T1NCeUlkIiwib3NSb3ciLCJmaW5kIiwiaXRlbXMiLCJpbmRleCIsImNoYXNzaVBhdGgiLCJDaGFzc2kiLCJQbGFjYSIsIk9MVCIsIkN0byIsIkJvb2xlYW4iLCJqb2luIiwiSWRDYWl4YSIsImN0byIsImVuZGVyZWNvIiwiRW5kZXJlY28iLCJsYXQiLCJMYXQiLCJwYXJzZUZsb2F0IiwibG9uZyIsIkxvbmciLCJTdGF0dXMiLCJkb25lIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(action-browser)/./src/lib/excel.ts\n");

/***/ })

};
;