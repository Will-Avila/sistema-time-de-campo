"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "_action-browser_src_lib_excel_ts";
exports.ids = ["_action-browser_src_lib_excel_ts"];
exports.modules = {

/***/ "(action-browser)/./src/lib/excel.ts":
/*!**************************!*\
  !*** ./src/lib/excel.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getAllOS: () => (/* binding */ getAllOS),\n/* harmony export */   getExcelData: () => (/* binding */ getExcelData),\n/* harmony export */   getOSById: () => (/* binding */ getOSById),\n/* harmony export */   invalidateExcelCache: () => (/* binding */ invalidateExcelCache)\n/* harmony export */ });\n/* harmony import */ var xlsx__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! xlsx */ \"(action-browser)/./node_modules/xlsx/xlsx.mjs\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs/promises */ \"fs/promises\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs_promises__WEBPACK_IMPORTED_MODULE_0__);\n\n\nconst EXCEL_PATH = process.env.EXCEL_PATH || \"C:\\\\Programas\\\\PROJETOS\\\\planilha\\\\Os.xlsx\";\n// ─── In-Memory Cache with TTL ───────────────────────────────────────\nconst CACHE_TTL_MS = 60 * 1000; // 60 seconds\nlet cache = null;\nfunction isCacheValid() {\n    return cache !== null && Date.now() - cache.timestamp < CACHE_TTL_MS;\n}\n/** Invalidate cache manually (e.g., if the file is known to have changed) */ function invalidateExcelCache() {\n    cache = null;\n}\n// ─── Helper Functions ───────────────────────────────────────────────\nfunction excelDateToJS(serial) {\n    if (!serial || isNaN(serial)) return null;\n    const utc_days = Math.floor(serial - 25569);\n    const utc_value = utc_days * 86400;\n    return new Date(utc_value * 1000);\n}\nfunction formatExcelDate(serial) {\n    if (typeof serial === \"number\") {\n        const date = excelDateToJS(serial);\n        return date ? date.toLocaleDateString(\"pt-BR\") : \"-\";\n    }\n    return String(serial || \"-\");\n}\n// ─── Core Data Access ───────────────────────────────────────────────\nasync function readExcelData() {\n    if (isCacheValid()) {\n        return {\n            osData: cache.osData,\n            caixaData: cache.caixaData\n        };\n    }\n    const buffer = await (0,fs_promises__WEBPACK_IMPORTED_MODULE_0__.readFile)(EXCEL_PATH);\n    const workbook = xlsx__WEBPACK_IMPORTED_MODULE_1__.read(buffer, {\n        type: \"buffer\"\n    });\n    const osSheet = workbook.Sheets[\"Os\"];\n    const osData = osSheet ? xlsx__WEBPACK_IMPORTED_MODULE_1__.utils.sheet_to_json(osSheet) : [];\n    const caixaSheet = workbook.Sheets[\"CaixaAlares\"];\n    const caixaData = caixaSheet ? xlsx__WEBPACK_IMPORTED_MODULE_1__.utils.sheet_to_json(caixaSheet) : [];\n    // Update cache\n    cache = {\n        osData,\n        caixaData,\n        timestamp: Date.now()\n    };\n    return {\n        osData,\n        caixaData\n    };\n}\n// ─── Public API ─────────────────────────────────────────────────────\nasync function getExcelData() {\n    return readExcelData();\n}\nasync function getAllOS() {\n    const { osData, caixaData } = await readExcelData();\n    return osData.map((row)=>{\n        const osId = String(row.IdOs || row.ID || \"\");\n        const totalCaixas = caixaData.filter((c)=>String(c.OS) === osId).length;\n        return {\n            id: osId,\n            pop: String(row.POP || row.Pop || \"\"),\n            status: String(row.StatusOperacao || \"\").trim(),\n            uf: String(row.UF || \"\"),\n            dataEntrante: formatExcelDate(row[\"Entrante\"]),\n            dataPrevExec: formatExcelDate(row[\"Prev. Exec.\"]),\n            rawPrevExec: typeof row[\"Prev. Exec.\"] === \"number\" ? row[\"Prev. Exec.\"] : 0,\n            dataConclusao: formatExcelDate(row[\"Conclusao\"]),\n            rawConclusao: typeof row[\"Conclusao\"] === \"number\" ? row[\"Conclusao\"] : 0,\n            cenario: String(row.Cenario || \"\"),\n            protocolo: String(row.Protocolo || \"\"),\n            totalCaixas\n        };\n    }).filter((os)=>{\n        const s = os.status.toLowerCase();\n        return s === \"iniciar\" || s === \"em execu\\xe7\\xe3o\" || s === \"em execucao\" || s === \"pend. cliente\" || s === \"conclu\\xeddo\" || s === \"concluido\" || s === \"cancelado\";\n    }).sort((a, b)=>a.rawPrevExec - b.rawPrevExec);\n}\nasync function getOSById(id) {\n    const { osData, caixaData } = await readExcelData();\n    const osRow = osData.find((row)=>String(row.IdOs || row.ID) === id || String(row.POP || row.Pop) === id);\n    if (!osRow) return null;\n    const osId = String(osRow.IdOs || osRow.ID);\n    const pop = String(osRow.POP || osRow.Pop);\n    const items = caixaData.filter((row)=>String(row.OS) === osId).map((row, index)=>{\n        const chassiPath = [\n            row.Pop || row.POP,\n            row.Chassi,\n            row.Placa,\n            row.OLT,\n            row.Cto\n        ].filter(Boolean).join(\"/\");\n        return {\n            id: String(row.IdCaixa || index),\n            cto: String(row.Cto || \"\"),\n            chassiPath,\n            endereco: String(row.Endereco || \"\"),\n            lat: row.Lat ? parseFloat(String(row.Lat)) : null,\n            long: row.Long ? parseFloat(String(row.Long)) : null,\n            status: String(row.Status || \"Pendente\"),\n            done: row.Status === \"OK\"\n        };\n    });\n    return {\n        id: String(osRow.IdOs || osRow.ID || pop),\n        pop,\n        status: String(osRow.StatusOperacao || \"\"),\n        protocolo: String(osRow.Protocolo || \"\"),\n        items\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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VHhDLElBQUl5QyxHQUFHO1lBQ1B6QyxJQUFJMEMsR0FBRztTQUNWLENBQUNyQyxNQUFNLENBQUNzQyxTQUFTQyxJQUFJLENBQUM7UUFFdkIsT0FBTztZQUNIbkMsSUFBSXpCLE9BQU9nQixJQUFJNkMsT0FBTyxJQUFJUjtZQUMxQlMsS0FBSzlELE9BQU9nQixJQUFJMEMsR0FBRyxJQUFJO1lBQ3ZCSjtZQUNBUyxVQUFVL0QsT0FBT2dCLElBQUlnRCxRQUFRLElBQUk7WUFDakNDLEtBQUtqRCxJQUFJa0QsR0FBRyxHQUFHQyxXQUFXbkUsT0FBT2dCLElBQUlrRCxHQUFHLEtBQUs7WUFDN0NFLE1BQU1wRCxJQUFJcUQsSUFBSSxHQUFHRixXQUFXbkUsT0FBT2dCLElBQUlxRCxJQUFJLEtBQUs7WUFDaER4QyxRQUFRN0IsT0FBT2dCLElBQUlzRCxNQUFNLElBQUk7WUFDN0JDLE1BQU12RCxJQUFJc0QsTUFBTSxLQUFLO1FBQ3pCO0lBQ0o7SUFFSixPQUFPO1FBQ0g3QyxJQUFJekIsT0FBT2tELE1BQU1oQyxJQUFJLElBQUlnQyxNQUFNL0IsRUFBRSxJQUFJTztRQUNyQ0E7UUFDQUcsUUFBUTdCLE9BQU9rRCxNQUFNcEIsY0FBYyxJQUFJO1FBQ3ZDVyxXQUFXekMsT0FBT2tELE1BQU1SLFNBQVMsSUFBSTtRQUNyQ1U7SUFDSjtBQUNKIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8veG9uLXNlcnZpY29zLy4vc3JjL2xpYi9leGNlbC50cz80N2NlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIFhMU1ggZnJvbSAneGxzeCc7XHJcbmltcG9ydCB7IHJlYWRGaWxlIH0gZnJvbSAnZnMvcHJvbWlzZXMnO1xyXG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgT1Mge1xyXG4gICAgaWQ6IHN0cmluZztcclxuICAgIHBvcDogc3RyaW5nO1xyXG4gICAgc3RhdHVzOiBzdHJpbmc7XHJcbiAgICB1Zjogc3RyaW5nO1xyXG4gICAgZGF0YUVudHJhbnRlOiBzdHJpbmc7XHJcbiAgICBkYXRhUHJldkV4ZWM6IHN0cmluZztcclxuICAgIHJhd1ByZXZFeGVjPzogbnVtYmVyO1xyXG4gICAgZGF0YUNvbmNsdXNhbz86IHN0cmluZztcclxuICAgIHJhd0NvbmNsdXNhbz86IG51bWJlcjtcclxuICAgIGNlbmFyaW86IHN0cmluZztcclxuICAgIHByb3RvY29sbzogc3RyaW5nO1xyXG4gICAgdG90YWxDYWl4YXM6IG51bWJlcjtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBDYWl4YUl0ZW0ge1xyXG4gICAgaWQ6IHN0cmluZztcclxuICAgIGN0bzogc3RyaW5nO1xyXG4gICAgY2hhc3NpUGF0aDogc3RyaW5nO1xyXG4gICAgZW5kZXJlY286IHN0cmluZztcclxuICAgIGxhdDogbnVtYmVyIHwgbnVsbDtcclxuICAgIGxvbmc6IG51bWJlciB8IG51bGw7XHJcbiAgICBzdGF0dXM6IHN0cmluZztcclxuICAgIGRvbmU6IGJvb2xlYW47XHJcbn1cclxuXHJcbmNvbnN0IEVYQ0VMX1BBVEggPSBwcm9jZXNzLmVudi5FWENFTF9QQVRIIHx8ICdDOlxcXFxQcm9ncmFtYXNcXFxcUFJPSkVUT1NcXFxccGxhbmlsaGFcXFxcT3MueGxzeCc7XHJcblxyXG4vLyDilIDilIDilIAgSW4tTWVtb3J5IENhY2hlIHdpdGggVFRMIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgFxyXG5jb25zdCBDQUNIRV9UVExfTVMgPSA2MCAqIDEwMDA7IC8vIDYwIHNlY29uZHNcclxuXHJcbmludGVyZmFjZSBFeGNlbENhY2hlIHtcclxuICAgIG9zRGF0YTogUmVjb3JkPHN0cmluZywgYW55PltdO1xyXG4gICAgY2FpeGFEYXRhOiBSZWNvcmQ8c3RyaW5nLCBhbnk+W107XHJcbiAgICB0aW1lc3RhbXA6IG51bWJlcjtcclxufVxyXG5cclxubGV0IGNhY2hlOiBFeGNlbENhY2hlIHwgbnVsbCA9IG51bGw7XHJcblxyXG5mdW5jdGlvbiBpc0NhY2hlVmFsaWQoKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gY2FjaGUgIT09IG51bGwgJiYgKERhdGUubm93KCkgLSBjYWNoZS50aW1lc3RhbXApIDwgQ0FDSEVfVFRMX01TO1xyXG59XHJcblxyXG4vKiogSW52YWxpZGF0ZSBjYWNoZSBtYW51YWxseSAoZS5nLiwgaWYgdGhlIGZpbGUgaXMga25vd24gdG8gaGF2ZSBjaGFuZ2VkKSAqL1xyXG5leHBvcnQgZnVuY3Rpb24gaW52YWxpZGF0ZUV4Y2VsQ2FjaGUoKSB7XHJcbiAgICBjYWNoZSA9IG51bGw7XHJcbn1cclxuXHJcbi8vIOKUgOKUgOKUgCBIZWxwZXIgRnVuY3Rpb25zIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgFxyXG5mdW5jdGlvbiBleGNlbERhdGVUb0pTKHNlcmlhbDogbnVtYmVyKTogRGF0ZSB8IG51bGwge1xyXG4gICAgaWYgKCFzZXJpYWwgfHwgaXNOYU4oc2VyaWFsKSkgcmV0dXJuIG51bGw7XHJcbiAgICBjb25zdCB1dGNfZGF5cyA9IE1hdGguZmxvb3Ioc2VyaWFsIC0gMjU1NjkpO1xyXG4gICAgY29uc3QgdXRjX3ZhbHVlID0gdXRjX2RheXMgKiA4NjQwMDtcclxuICAgIHJldHVybiBuZXcgRGF0ZSh1dGNfdmFsdWUgKiAxMDAwKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZm9ybWF0RXhjZWxEYXRlKHNlcmlhbDogYW55KTogc3RyaW5nIHtcclxuICAgIGlmICh0eXBlb2Ygc2VyaWFsID09PSAnbnVtYmVyJykge1xyXG4gICAgICAgIGNvbnN0IGRhdGUgPSBleGNlbERhdGVUb0pTKHNlcmlhbCk7XHJcbiAgICAgICAgcmV0dXJuIGRhdGUgPyBkYXRlLnRvTG9jYWxlRGF0ZVN0cmluZygncHQtQlInKSA6ICctJztcclxuICAgIH1cclxuICAgIHJldHVybiBTdHJpbmcoc2VyaWFsIHx8ICctJyk7XHJcbn1cclxuXHJcbi8vIOKUgOKUgOKUgCBDb3JlIERhdGEgQWNjZXNzIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgFxyXG5hc3luYyBmdW5jdGlvbiByZWFkRXhjZWxEYXRhKCk6IFByb21pc2U8eyBvc0RhdGE6IFJlY29yZDxzdHJpbmcsIGFueT5bXTsgY2FpeGFEYXRhOiBSZWNvcmQ8c3RyaW5nLCBhbnk+W10gfT4ge1xyXG4gICAgaWYgKGlzQ2FjaGVWYWxpZCgpKSB7XHJcbiAgICAgICAgcmV0dXJuIHsgb3NEYXRhOiBjYWNoZSEub3NEYXRhLCBjYWl4YURhdGE6IGNhY2hlIS5jYWl4YURhdGEgfTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBidWZmZXIgPSBhd2FpdCByZWFkRmlsZShFWENFTF9QQVRIKTtcclxuICAgIGNvbnN0IHdvcmtib29rID0gWExTWC5yZWFkKGJ1ZmZlciwgeyB0eXBlOiAnYnVmZmVyJyB9KTtcclxuXHJcbiAgICBjb25zdCBvc1NoZWV0ID0gd29ya2Jvb2suU2hlZXRzWydPcyddO1xyXG4gICAgY29uc3Qgb3NEYXRhOiBSZWNvcmQ8c3RyaW5nLCBhbnk+W10gPSBvc1NoZWV0ID8gWExTWC51dGlscy5zaGVldF90b19qc29uKG9zU2hlZXQpIDogW107XHJcblxyXG4gICAgY29uc3QgY2FpeGFTaGVldCA9IHdvcmtib29rLlNoZWV0c1snQ2FpeGFBbGFyZXMnXTtcclxuICAgIGNvbnN0IGNhaXhhRGF0YTogUmVjb3JkPHN0cmluZywgYW55PltdID0gY2FpeGFTaGVldCA/IFhMU1gudXRpbHMuc2hlZXRfdG9fanNvbihjYWl4YVNoZWV0KSA6IFtdO1xyXG5cclxuICAgIC8vIFVwZGF0ZSBjYWNoZVxyXG4gICAgY2FjaGUgPSB7IG9zRGF0YSwgY2FpeGFEYXRhLCB0aW1lc3RhbXA6IERhdGUubm93KCkgfTtcclxuXHJcbiAgICByZXR1cm4geyBvc0RhdGEsIGNhaXhhRGF0YSB9O1xyXG59XHJcblxyXG4vLyDilIDilIDilIAgUHVibGljIEFQSSDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIBcclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEV4Y2VsRGF0YSgpIHtcclxuICAgIHJldHVybiByZWFkRXhjZWxEYXRhKCk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBbGxPUygpOiBQcm9taXNlPE9TW10+IHtcclxuICAgIGNvbnN0IHsgb3NEYXRhLCBjYWl4YURhdGEgfSA9IGF3YWl0IHJlYWRFeGNlbERhdGEoKTtcclxuXHJcbiAgICByZXR1cm4gb3NEYXRhXHJcbiAgICAgICAgLm1hcCgocm93KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG9zSWQgPSBTdHJpbmcocm93LklkT3MgfHwgcm93LklEIHx8ICcnKTtcclxuICAgICAgICAgICAgY29uc3QgdG90YWxDYWl4YXMgPSBjYWl4YURhdGEuZmlsdGVyKChjKSA9PiBTdHJpbmcoYy5PUykgPT09IG9zSWQpLmxlbmd0aDtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBpZDogb3NJZCxcclxuICAgICAgICAgICAgICAgIHBvcDogU3RyaW5nKHJvdy5QT1AgfHwgcm93LlBvcCB8fCAnJyksXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IFN0cmluZyhyb3cuU3RhdHVzT3BlcmFjYW8gfHwgJycpLnRyaW0oKSxcclxuICAgICAgICAgICAgICAgIHVmOiBTdHJpbmcocm93LlVGIHx8ICcnKSxcclxuICAgICAgICAgICAgICAgIGRhdGFFbnRyYW50ZTogZm9ybWF0RXhjZWxEYXRlKHJvd1snRW50cmFudGUnXSksXHJcbiAgICAgICAgICAgICAgICBkYXRhUHJldkV4ZWM6IGZvcm1hdEV4Y2VsRGF0ZShyb3dbJ1ByZXYuIEV4ZWMuJ10pLFxyXG4gICAgICAgICAgICAgICAgcmF3UHJldkV4ZWM6IHR5cGVvZiByb3dbJ1ByZXYuIEV4ZWMuJ10gPT09ICdudW1iZXInID8gcm93WydQcmV2LiBFeGVjLiddIDogMCxcclxuICAgICAgICAgICAgICAgIGRhdGFDb25jbHVzYW86IGZvcm1hdEV4Y2VsRGF0ZShyb3dbJ0NvbmNsdXNhbyddKSxcclxuICAgICAgICAgICAgICAgIHJhd0NvbmNsdXNhbzogdHlwZW9mIHJvd1snQ29uY2x1c2FvJ10gPT09ICdudW1iZXInID8gcm93WydDb25jbHVzYW8nXSA6IDAsXHJcbiAgICAgICAgICAgICAgICBjZW5hcmlvOiBTdHJpbmcocm93LkNlbmFyaW8gfHwgJycpLFxyXG4gICAgICAgICAgICAgICAgcHJvdG9jb2xvOiBTdHJpbmcocm93LlByb3RvY29sbyB8fCAnJyksXHJcbiAgICAgICAgICAgICAgICB0b3RhbENhaXhhc1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmZpbHRlcigob3MpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgcyA9IG9zLnN0YXR1cy50b0xvd2VyQ2FzZSgpO1xyXG4gICAgICAgICAgICByZXR1cm4gcyA9PT0gJ2luaWNpYXInIHx8IHMgPT09ICdlbSBleGVjdcOnw6NvJyB8fCBzID09PSAnZW0gZXhlY3VjYW8nXHJcbiAgICAgICAgICAgICAgICB8fCBzID09PSAncGVuZC4gY2xpZW50ZScgfHwgcyA9PT0gJ2NvbmNsdcOtZG8nIHx8IHMgPT09ICdjb25jbHVpZG8nXHJcbiAgICAgICAgICAgICAgICB8fCBzID09PSAnY2FuY2VsYWRvJztcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5zb3J0KChhLCBiKSA9PiBhLnJhd1ByZXZFeGVjIC0gYi5yYXdQcmV2RXhlYyk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRPU0J5SWQoaWQ6IHN0cmluZykge1xyXG4gICAgY29uc3QgeyBvc0RhdGEsIGNhaXhhRGF0YSB9ID0gYXdhaXQgcmVhZEV4Y2VsRGF0YSgpO1xyXG5cclxuICAgIGNvbnN0IG9zUm93ID0gb3NEYXRhLmZpbmQoKHJvdykgPT4gU3RyaW5nKHJvdy5JZE9zIHx8IHJvdy5JRCkgPT09IGlkIHx8IFN0cmluZyhyb3cuUE9QIHx8IHJvdy5Qb3ApID09PSBpZCk7XHJcblxyXG4gICAgaWYgKCFvc1JvdykgcmV0dXJuIG51bGw7XHJcblxyXG4gICAgY29uc3Qgb3NJZCA9IFN0cmluZyhvc1Jvdy5JZE9zIHx8IG9zUm93LklEKTtcclxuICAgIGNvbnN0IHBvcCA9IFN0cmluZyhvc1Jvdy5QT1AgfHwgb3NSb3cuUG9wKTtcclxuXHJcbiAgICBjb25zdCBpdGVtczogQ2FpeGFJdGVtW10gPSBjYWl4YURhdGFcclxuICAgICAgICAuZmlsdGVyKChyb3cpID0+IFN0cmluZyhyb3cuT1MpID09PSBvc0lkKVxyXG4gICAgICAgIC5tYXAoKHJvdywgaW5kZXgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY2hhc3NpUGF0aCA9IFtcclxuICAgICAgICAgICAgICAgIHJvdy5Qb3AgfHwgcm93LlBPUCxcclxuICAgICAgICAgICAgICAgIHJvdy5DaGFzc2ksXHJcbiAgICAgICAgICAgICAgICByb3cuUGxhY2EsXHJcbiAgICAgICAgICAgICAgICByb3cuT0xULFxyXG4gICAgICAgICAgICAgICAgcm93LkN0b1xyXG4gICAgICAgICAgICBdLmZpbHRlcihCb29sZWFuKS5qb2luKCcvJyk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgaWQ6IFN0cmluZyhyb3cuSWRDYWl4YSB8fCBpbmRleCksXHJcbiAgICAgICAgICAgICAgICBjdG86IFN0cmluZyhyb3cuQ3RvIHx8ICcnKSxcclxuICAgICAgICAgICAgICAgIGNoYXNzaVBhdGgsXHJcbiAgICAgICAgICAgICAgICBlbmRlcmVjbzogU3RyaW5nKHJvdy5FbmRlcmVjbyB8fCAnJyksXHJcbiAgICAgICAgICAgICAgICBsYXQ6IHJvdy5MYXQgPyBwYXJzZUZsb2F0KFN0cmluZyhyb3cuTGF0KSkgOiBudWxsLFxyXG4gICAgICAgICAgICAgICAgbG9uZzogcm93LkxvbmcgPyBwYXJzZUZsb2F0KFN0cmluZyhyb3cuTG9uZykpIDogbnVsbCxcclxuICAgICAgICAgICAgICAgIHN0YXR1czogU3RyaW5nKHJvdy5TdGF0dXMgfHwgJ1BlbmRlbnRlJyksXHJcbiAgICAgICAgICAgICAgICBkb25lOiByb3cuU3RhdHVzID09PSAnT0snXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBpZDogU3RyaW5nKG9zUm93LklkT3MgfHwgb3NSb3cuSUQgfHwgcG9wKSxcclxuICAgICAgICBwb3AsXHJcbiAgICAgICAgc3RhdHVzOiBTdHJpbmcob3NSb3cuU3RhdHVzT3BlcmFjYW8gfHwgJycpLFxyXG4gICAgICAgIHByb3RvY29sbzogU3RyaW5nKG9zUm93LlByb3RvY29sbyB8fCAnJyksXHJcbiAgICAgICAgaXRlbXNcclxuICAgIH07XHJcbn1cclxuIl0sIm5hbWVzIjpbIlhMU1giLCJyZWFkRmlsZSIsIkVYQ0VMX1BBVEgiLCJwcm9jZXNzIiwiZW52IiwiQ0FDSEVfVFRMX01TIiwiY2FjaGUiLCJpc0NhY2hlVmFsaWQiLCJEYXRlIiwibm93IiwidGltZXN0YW1wIiwiaW52YWxpZGF0ZUV4Y2VsQ2FjaGUiLCJleGNlbERhdGVUb0pTIiwic2VyaWFsIiwiaXNOYU4iLCJ1dGNfZGF5cyIsIk1hdGgiLCJmbG9vciIsInV0Y192YWx1ZSIsImZvcm1hdEV4Y2VsRGF0ZSIsImRhdGUiLCJ0b0xvY2FsZURhdGVTdHJpbmciLCJTdHJpbmciLCJyZWFkRXhjZWxEYXRhIiwib3NEYXRhIiwiY2FpeGFEYXRhIiwiYnVmZmVyIiwid29ya2Jvb2siLCJyZWFkIiwidHlwZSIsIm9zU2hlZXQiLCJTaGVldHMiLCJ1dGlscyIsInNoZWV0X3RvX2pzb24iLCJjYWl4YVNoZWV0IiwiZ2V0RXhjZWxEYXRhIiwiZ2V0QWxsT1MiLCJtYXAiLCJyb3ciLCJvc0lkIiwiSWRPcyIsIklEIiwidG90YWxDYWl4YXMiLCJmaWx0ZXIiLCJjIiwiT1MiLCJsZW5ndGgiLCJpZCIsInBvcCIsIlBPUCIsIlBvcCIsInN0YXR1cyIsIlN0YXR1c09wZXJhY2FvIiwidHJpbSIsInVmIiwiVUYiLCJkYXRhRW50cmFudGUiLCJkYXRhUHJldkV4ZWMiLCJyYXdQcmV2RXhlYyIsImRhdGFDb25jbHVzYW8iLCJyYXdDb25jbHVzYW8iLCJjZW5hcmlvIiwiQ2VuYXJpbyIsInByb3RvY29sbyIsIlByb3RvY29sbyIsIm9zIiwicyIsInRvTG93ZXJDYXNlIiwic29ydCIsImEiLCJiIiwiZ2V0T1NCeUlkIiwib3NSb3ciLCJmaW5kIiwiaXRlbXMiLCJpbmRleCIsImNoYXNzaVBhdGgiLCJDaGFzc2kiLCJQbGFjYSIsIk9MVCIsIkN0byIsIkJvb2xlYW4iLCJqb2luIiwiSWRDYWl4YSIsImN0byIsImVuZGVyZWNvIiwiRW5kZXJlY28iLCJsYXQiLCJMYXQiLCJwYXJzZUZsb2F0IiwibG9uZyIsIkxvbmciLCJTdGF0dXMiLCJkb25lIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(action-browser)/./src/lib/excel.ts\n");

/***/ })

};
;