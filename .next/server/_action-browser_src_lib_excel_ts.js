"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "_action-browser_src_lib_excel_ts";
exports.ids = ["_action-browser_src_lib_excel_ts"];
exports.modules = {

/***/ "(action-browser)/./src/lib/excel.ts":
/*!**************************!*\
  !*** ./src/lib/excel.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ALLOWED_STATUSES: () => (/* binding */ ALLOWED_STATUSES),\n/* harmony export */   getAllOS: () => (/* binding */ getAllOS),\n/* harmony export */   getExcelData: () => (/* binding */ getExcelData),\n/* harmony export */   getOSById: () => (/* binding */ getOSById),\n/* harmony export */   invalidateExcelCache: () => (/* binding */ invalidateExcelCache)\n/* harmony export */ });\n/* harmony import */ var xlsx__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! xlsx */ \"(action-browser)/./node_modules/xlsx/xlsx.mjs\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs/promises */ \"fs/promises\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs_promises__WEBPACK_IMPORTED_MODULE_0__);\n\n\nconst ALLOWED_STATUSES = [\n    \"iniciar\",\n    \"em execu\\xe7\\xe3o\",\n    \"em execucao\",\n    \"pend. cliente\",\n    \"conclu\\xeddo\",\n    \"concluido\",\n    \"encerrada\",\n    \"cancelado\"\n];\nconst EXCEL_PATH = process.env.EXCEL_PATH || \"C:\\\\Programas\\\\PROJETOS\\\\planilha\\\\Os.xlsx\";\n// ─── In-Memory Cache with TTL ───────────────────────────────────────\nconst CACHE_TTL_MS = 60 * 1000; // 60 seconds\nlet cache = null;\nfunction isCacheValid() {\n    return cache !== null && Date.now() - cache.timestamp < CACHE_TTL_MS;\n}\n/** Invalidate cache manually (e.g., if the file is known to have changed) */ function invalidateExcelCache() {\n    cache = null;\n}\n// ─── Helper Functions ───────────────────────────────────────────────\nfunction excelDateToJS(serial) {\n    if (!serial || isNaN(serial)) return null;\n    const utc_days = Math.floor(serial - 25569);\n    const utc_value = utc_days * 86400;\n    return new Date(utc_value * 1000);\n}\nfunction formatExcelDate(serial) {\n    if (typeof serial === \"number\") {\n        const date = excelDateToJS(serial);\n        return date ? date.toLocaleDateString(\"pt-BR\") : \"-\";\n    }\n    return String(serial || \"-\");\n}\n// ─── Core Data Access ───────────────────────────────────────────────\nasync function readExcelData() {\n    if (isCacheValid()) {\n        return {\n            osData: cache.osData,\n            caixaData: cache.caixaData\n        };\n    }\n    const buffer = await (0,fs_promises__WEBPACK_IMPORTED_MODULE_0__.readFile)(EXCEL_PATH);\n    const workbook = xlsx__WEBPACK_IMPORTED_MODULE_1__.read(buffer, {\n        type: \"buffer\"\n    });\n    const osSheet = workbook.Sheets[\"Os\"];\n    const osData = osSheet ? xlsx__WEBPACK_IMPORTED_MODULE_1__.utils.sheet_to_json(osSheet) : [];\n    const caixaSheet = workbook.Sheets[\"CaixaAlares\"];\n    const caixaData = caixaSheet ? xlsx__WEBPACK_IMPORTED_MODULE_1__.utils.sheet_to_json(caixaSheet) : [];\n    // Update cache\n    cache = {\n        osData,\n        caixaData,\n        timestamp: Date.now()\n    };\n    return {\n        osData,\n        caixaData\n    };\n}\n// ─── Public API ─────────────────────────────────────────────────────\nasync function getExcelData() {\n    return readExcelData();\n}\nasync function getAllOS() {\n    const { osData, caixaData } = await readExcelData();\n    return osData.map((row)=>{\n        const osId = String(row.IdOs || row.ID || \"\");\n        const totalCaixas = caixaData.filter((c)=>String(c.OS) === osId).length;\n        return {\n            id: osId,\n            pop: String(row.POP || row.Pop || \"\"),\n            status: String(row.StatusOperacao || \"\").trim(),\n            uf: String(row.UF || \"\"),\n            dataEntrante: formatExcelDate(row[\"Entrante\"]),\n            dataPrevExec: formatExcelDate(row[\"Prev. Exec.\"]),\n            rawPrevExec: typeof row[\"Prev. Exec.\"] === \"number\" ? row[\"Prev. Exec.\"] : 0,\n            dataConclusao: formatExcelDate(row[\"Conclusao\"]),\n            rawConclusao: typeof row[\"Conclusao\"] === \"number\" ? row[\"Conclusao\"] : 0,\n            cenario: String(row.Cenario || \"\"),\n            protocolo: String(row.Protocolo || \"\"),\n            totalCaixas\n        };\n    }).filter((os)=>{\n        const s = os.status.toLowerCase();\n        return s === \"iniciar\" || s === \"em execu\\xe7\\xe3o\" || s === \"em execucao\" || s === \"pend. cliente\" || s === \"conclu\\xeddo\" || s === \"concluido\" || s === \"encerrada\" || s === \"cancelado\";\n    }).sort((a, b)=>a.rawPrevExec - b.rawPrevExec);\n}\nasync function getOSById(id) {\n    const { osData, caixaData } = await readExcelData();\n    const osRow = osData.find((row)=>String(row.IdOs || row.ID) === id || String(row.POP || row.Pop) === id);\n    if (!osRow) return null;\n    const osId = String(osRow.IdOs || osRow.ID);\n    const pop = String(osRow.POP || osRow.Pop);\n    const items = caixaData.filter((row)=>String(row.OS) === osId).map((row, index)=>{\n        const chassiPath = [\n            row.Pop || row.POP,\n            row.Chassi,\n            row.Placa,\n            row.OLT,\n            row.Cto\n        ].filter(Boolean).join(\"/\");\n        return {\n            id: String(row.IdCaixa || index),\n            cto: String(row.Cto || \"\"),\n            chassiPath,\n            endereco: String(row.Endereco || \"\"),\n            lat: row.Lat ? parseFloat(String(row.Lat)) : null,\n            long: row.Long ? parseFloat(String(row.Long)) : null,\n            status: String(row.Status || \"Pendente\"),\n            done: row.Status === \"OK\"\n        };\n    });\n    return {\n        id: String(osRow.IdOs || osRow.ID || pop),\n        pop,\n        status: String(osRow.StatusOperacao || \"\"),\n        protocolo: String(osRow.Protocolo || \"\"),\n        items\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LGFBQWE7WUFDZnRDLElBQUlZLEdBQUcsSUFBSVosSUFBSVcsR0FBRztZQUNsQlgsSUFBSXVDLE1BQU07WUFDVnZDLElBQUl3QyxLQUFLO1lBQ1R4QyxJQUFJeUMsR0FBRztZQUNQekMsSUFBSTBDLEdBQUc7U0FDVixDQUFDckMsTUFBTSxDQUFDc0MsU0FBU0MsSUFBSSxDQUFDO1FBRXZCLE9BQU87WUFDSG5DLElBQUl6QixPQUFPZ0IsSUFBSTZDLE9BQU8sSUFBSVI7WUFDMUJTLEtBQUs5RCxPQUFPZ0IsSUFBSTBDLEdBQUcsSUFBSTtZQUN2Qko7WUFDQVMsVUFBVS9ELE9BQU9nQixJQUFJZ0QsUUFBUSxJQUFJO1lBQ2pDQyxLQUFLakQsSUFBSWtELEdBQUcsR0FBR0MsV0FBV25FLE9BQU9nQixJQUFJa0QsR0FBRyxLQUFLO1lBQzdDRSxNQUFNcEQsSUFBSXFELElBQUksR0FBR0YsV0FBV25FLE9BQU9nQixJQUFJcUQsSUFBSSxLQUFLO1lBQ2hEeEMsUUFBUTdCLE9BQU9nQixJQUFJc0QsTUFBTSxJQUFJO1lBQzdCQyxNQUFNdkQsSUFBSXNELE1BQU0sS0FBSztRQUN6QjtJQUNKO0lBRUosT0FBTztRQUNIN0MsSUFBSXpCLE9BQU9rRCxNQUFNaEMsSUFBSSxJQUFJZ0MsTUFBTS9CLEVBQUUsSUFBSU87UUFDckNBO1FBQ0FHLFFBQVE3QixPQUFPa0QsTUFBTXBCLGNBQWMsSUFBSTtRQUN2Q1csV0FBV3pDLE9BQU9rRCxNQUFNUixTQUFTLElBQUk7UUFDckNVO0lBQ0o7QUFDSiIsInNvdXJjZXMiOlsid2VicGFjazovL3hvbi1zZXJ2aWNvcy8uL3NyYy9saWIvZXhjZWwudHM/NDdjZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBYTFNYIGZyb20gJ3hsc3gnO1xyXG5pbXBvcnQgeyByZWFkRmlsZSB9IGZyb20gJ2ZzL3Byb21pc2VzJztcclxuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIE9TIHtcclxuICAgIGlkOiBzdHJpbmc7XHJcbiAgICBwb3A6IHN0cmluZztcclxuICAgIHN0YXR1czogc3RyaW5nO1xyXG4gICAgdWY6IHN0cmluZztcclxuICAgIGRhdGFFbnRyYW50ZTogc3RyaW5nO1xyXG4gICAgZGF0YVByZXZFeGVjOiBzdHJpbmc7XHJcbiAgICByYXdQcmV2RXhlYz86IG51bWJlcjtcclxuICAgIGRhdGFDb25jbHVzYW8/OiBzdHJpbmc7XHJcbiAgICByYXdDb25jbHVzYW8/OiBudW1iZXI7XHJcbiAgICBjZW5hcmlvOiBzdHJpbmc7XHJcbiAgICBwcm90b2NvbG86IHN0cmluZztcclxuICAgIHRvdGFsQ2FpeGFzOiBudW1iZXI7XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgQ2FpeGFJdGVtIHtcclxuICAgIGlkOiBzdHJpbmc7XHJcbiAgICBjdG86IHN0cmluZztcclxuICAgIGNoYXNzaVBhdGg6IHN0cmluZztcclxuICAgIGVuZGVyZWNvOiBzdHJpbmc7XHJcbiAgICBsYXQ6IG51bWJlciB8IG51bGw7XHJcbiAgICBsb25nOiBudW1iZXIgfCBudWxsO1xyXG4gICAgc3RhdHVzOiBzdHJpbmc7XHJcbiAgICBkb25lOiBib29sZWFuO1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgQUxMT1dFRF9TVEFUVVNFUyA9IFsnaW5pY2lhcicsICdlbSBleGVjdcOnw6NvJywgJ2VtIGV4ZWN1Y2FvJywgJ3BlbmQuIGNsaWVudGUnLCAnY29uY2x1w61kbycsICdjb25jbHVpZG8nLCAnZW5jZXJyYWRhJywgJ2NhbmNlbGFkbyddO1xyXG5cclxuY29uc3QgRVhDRUxfUEFUSCA9IHByb2Nlc3MuZW52LkVYQ0VMX1BBVEggfHwgJ0M6XFxcXFByb2dyYW1hc1xcXFxQUk9KRVRPU1xcXFxwbGFuaWxoYVxcXFxPcy54bHN4JztcclxuXHJcbi8vIOKUgOKUgOKUgCBJbi1NZW1vcnkgQ2FjaGUgd2l0aCBUVEwg4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAXHJcbmNvbnN0IENBQ0hFX1RUTF9NUyA9IDYwICogMTAwMDsgLy8gNjAgc2Vjb25kc1xyXG5cclxuaW50ZXJmYWNlIEV4Y2VsQ2FjaGUge1xyXG4gICAgb3NEYXRhOiBSZWNvcmQ8c3RyaW5nLCBhbnk+W107XHJcbiAgICBjYWl4YURhdGE6IFJlY29yZDxzdHJpbmcsIGFueT5bXTtcclxuICAgIHRpbWVzdGFtcDogbnVtYmVyO1xyXG59XHJcblxyXG5sZXQgY2FjaGU6IEV4Y2VsQ2FjaGUgfCBudWxsID0gbnVsbDtcclxuXHJcbmZ1bmN0aW9uIGlzQ2FjaGVWYWxpZCgpOiBib29sZWFuIHtcclxuICAgIHJldHVybiBjYWNoZSAhPT0gbnVsbCAmJiAoRGF0ZS5ub3coKSAtIGNhY2hlLnRpbWVzdGFtcCkgPCBDQUNIRV9UVExfTVM7XHJcbn1cclxuXHJcbi8qKiBJbnZhbGlkYXRlIGNhY2hlIG1hbnVhbGx5IChlLmcuLCBpZiB0aGUgZmlsZSBpcyBrbm93biB0byBoYXZlIGNoYW5nZWQpICovXHJcbmV4cG9ydCBmdW5jdGlvbiBpbnZhbGlkYXRlRXhjZWxDYWNoZSgpIHtcclxuICAgIGNhY2hlID0gbnVsbDtcclxufVxyXG5cclxuLy8g4pSA4pSA4pSAIEhlbHBlciBGdW5jdGlvbnMg4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAXHJcbmZ1bmN0aW9uIGV4Y2VsRGF0ZVRvSlMoc2VyaWFsOiBudW1iZXIpOiBEYXRlIHwgbnVsbCB7XHJcbiAgICBpZiAoIXNlcmlhbCB8fCBpc05hTihzZXJpYWwpKSByZXR1cm4gbnVsbDtcclxuICAgIGNvbnN0IHV0Y19kYXlzID0gTWF0aC5mbG9vcihzZXJpYWwgLSAyNTU2OSk7XHJcbiAgICBjb25zdCB1dGNfdmFsdWUgPSB1dGNfZGF5cyAqIDg2NDAwO1xyXG4gICAgcmV0dXJuIG5ldyBEYXRlKHV0Y192YWx1ZSAqIDEwMDApO1xyXG59XHJcblxyXG5mdW5jdGlvbiBmb3JtYXRFeGNlbERhdGUoc2VyaWFsOiBhbnkpOiBzdHJpbmcge1xyXG4gICAgaWYgKHR5cGVvZiBzZXJpYWwgPT09ICdudW1iZXInKSB7XHJcbiAgICAgICAgY29uc3QgZGF0ZSA9IGV4Y2VsRGF0ZVRvSlMoc2VyaWFsKTtcclxuICAgICAgICByZXR1cm4gZGF0ZSA/IGRhdGUudG9Mb2NhbGVEYXRlU3RyaW5nKCdwdC1CUicpIDogJy0nO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFN0cmluZyhzZXJpYWwgfHwgJy0nKTtcclxufVxyXG5cclxuLy8g4pSA4pSA4pSAIENvcmUgRGF0YSBBY2Nlc3Mg4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAXHJcbmFzeW5jIGZ1bmN0aW9uIHJlYWRFeGNlbERhdGEoKTogUHJvbWlzZTx7IG9zRGF0YTogUmVjb3JkPHN0cmluZywgYW55PltdOyBjYWl4YURhdGE6IFJlY29yZDxzdHJpbmcsIGFueT5bXSB9PiB7XHJcbiAgICBpZiAoaXNDYWNoZVZhbGlkKCkpIHtcclxuICAgICAgICByZXR1cm4geyBvc0RhdGE6IGNhY2hlIS5vc0RhdGEsIGNhaXhhRGF0YTogY2FjaGUhLmNhaXhhRGF0YSB9O1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGJ1ZmZlciA9IGF3YWl0IHJlYWRGaWxlKEVYQ0VMX1BBVEgpO1xyXG4gICAgY29uc3Qgd29ya2Jvb2sgPSBYTFNYLnJlYWQoYnVmZmVyLCB7IHR5cGU6ICdidWZmZXInIH0pO1xyXG5cclxuICAgIGNvbnN0IG9zU2hlZXQgPSB3b3JrYm9vay5TaGVldHNbJ09zJ107XHJcbiAgICBjb25zdCBvc0RhdGE6IFJlY29yZDxzdHJpbmcsIGFueT5bXSA9IG9zU2hlZXQgPyBYTFNYLnV0aWxzLnNoZWV0X3RvX2pzb24ob3NTaGVldCkgOiBbXTtcclxuXHJcbiAgICBjb25zdCBjYWl4YVNoZWV0ID0gd29ya2Jvb2suU2hlZXRzWydDYWl4YUFsYXJlcyddO1xyXG4gICAgY29uc3QgY2FpeGFEYXRhOiBSZWNvcmQ8c3RyaW5nLCBhbnk+W10gPSBjYWl4YVNoZWV0ID8gWExTWC51dGlscy5zaGVldF90b19qc29uKGNhaXhhU2hlZXQpIDogW107XHJcblxyXG4gICAgLy8gVXBkYXRlIGNhY2hlXHJcbiAgICBjYWNoZSA9IHsgb3NEYXRhLCBjYWl4YURhdGEsIHRpbWVzdGFtcDogRGF0ZS5ub3coKSB9O1xyXG5cclxuICAgIHJldHVybiB7IG9zRGF0YSwgY2FpeGFEYXRhIH07XHJcbn1cclxuXHJcbi8vIOKUgOKUgOKUgCBQdWJsaWMgQVBJIOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgFxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RXhjZWxEYXRhKCkge1xyXG4gICAgcmV0dXJuIHJlYWRFeGNlbERhdGEoKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFsbE9TKCk6IFByb21pc2U8T1NbXT4ge1xyXG4gICAgY29uc3QgeyBvc0RhdGEsIGNhaXhhRGF0YSB9ID0gYXdhaXQgcmVhZEV4Y2VsRGF0YSgpO1xyXG5cclxuICAgIHJldHVybiBvc0RhdGFcclxuICAgICAgICAubWFwKChyb3cpID0+IHtcclxuICAgICAgICAgICAgY29uc3Qgb3NJZCA9IFN0cmluZyhyb3cuSWRPcyB8fCByb3cuSUQgfHwgJycpO1xyXG4gICAgICAgICAgICBjb25zdCB0b3RhbENhaXhhcyA9IGNhaXhhRGF0YS5maWx0ZXIoKGMpID0+IFN0cmluZyhjLk9TKSA9PT0gb3NJZCkubGVuZ3RoO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIGlkOiBvc0lkLFxyXG4gICAgICAgICAgICAgICAgcG9wOiBTdHJpbmcocm93LlBPUCB8fCByb3cuUG9wIHx8ICcnKSxcclxuICAgICAgICAgICAgICAgIHN0YXR1czogU3RyaW5nKHJvdy5TdGF0dXNPcGVyYWNhbyB8fCAnJykudHJpbSgpLFxyXG4gICAgICAgICAgICAgICAgdWY6IFN0cmluZyhyb3cuVUYgfHwgJycpLFxyXG4gICAgICAgICAgICAgICAgZGF0YUVudHJhbnRlOiBmb3JtYXRFeGNlbERhdGUocm93WydFbnRyYW50ZSddKSxcclxuICAgICAgICAgICAgICAgIGRhdGFQcmV2RXhlYzogZm9ybWF0RXhjZWxEYXRlKHJvd1snUHJldi4gRXhlYy4nXSksXHJcbiAgICAgICAgICAgICAgICByYXdQcmV2RXhlYzogdHlwZW9mIHJvd1snUHJldi4gRXhlYy4nXSA9PT0gJ251bWJlcicgPyByb3dbJ1ByZXYuIEV4ZWMuJ10gOiAwLFxyXG4gICAgICAgICAgICAgICAgZGF0YUNvbmNsdXNhbzogZm9ybWF0RXhjZWxEYXRlKHJvd1snQ29uY2x1c2FvJ10pLFxyXG4gICAgICAgICAgICAgICAgcmF3Q29uY2x1c2FvOiB0eXBlb2Ygcm93WydDb25jbHVzYW8nXSA9PT0gJ251bWJlcicgPyByb3dbJ0NvbmNsdXNhbyddIDogMCxcclxuICAgICAgICAgICAgICAgIGNlbmFyaW86IFN0cmluZyhyb3cuQ2VuYXJpbyB8fCAnJyksXHJcbiAgICAgICAgICAgICAgICBwcm90b2NvbG86IFN0cmluZyhyb3cuUHJvdG9jb2xvIHx8ICcnKSxcclxuICAgICAgICAgICAgICAgIHRvdGFsQ2FpeGFzXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuZmlsdGVyKChvcykgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBzID0gb3Muc3RhdHVzLnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgICAgIHJldHVybiBzID09PSAnaW5pY2lhcicgfHwgcyA9PT0gJ2VtIGV4ZWN1w6fDo28nIHx8IHMgPT09ICdlbSBleGVjdWNhbydcclxuICAgICAgICAgICAgICAgIHx8IHMgPT09ICdwZW5kLiBjbGllbnRlJyB8fCBzID09PSAnY29uY2x1w61kbycgfHwgcyA9PT0gJ2NvbmNsdWlkbydcclxuICAgICAgICAgICAgICAgIHx8IHMgPT09ICdlbmNlcnJhZGEnIHx8IHMgPT09ICdjYW5jZWxhZG8nO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLnNvcnQoKGEsIGIpID0+IGEucmF3UHJldkV4ZWMgLSBiLnJhd1ByZXZFeGVjKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldE9TQnlJZChpZDogc3RyaW5nKSB7XHJcbiAgICBjb25zdCB7IG9zRGF0YSwgY2FpeGFEYXRhIH0gPSBhd2FpdCByZWFkRXhjZWxEYXRhKCk7XHJcblxyXG4gICAgY29uc3Qgb3NSb3cgPSBvc0RhdGEuZmluZCgocm93KSA9PiBTdHJpbmcocm93LklkT3MgfHwgcm93LklEKSA9PT0gaWQgfHwgU3RyaW5nKHJvdy5QT1AgfHwgcm93LlBvcCkgPT09IGlkKTtcclxuXHJcbiAgICBpZiAoIW9zUm93KSByZXR1cm4gbnVsbDtcclxuXHJcbiAgICBjb25zdCBvc0lkID0gU3RyaW5nKG9zUm93LklkT3MgfHwgb3NSb3cuSUQpO1xyXG4gICAgY29uc3QgcG9wID0gU3RyaW5nKG9zUm93LlBPUCB8fCBvc1Jvdy5Qb3ApO1xyXG5cclxuICAgIGNvbnN0IGl0ZW1zOiBDYWl4YUl0ZW1bXSA9IGNhaXhhRGF0YVxyXG4gICAgICAgIC5maWx0ZXIoKHJvdykgPT4gU3RyaW5nKHJvdy5PUykgPT09IG9zSWQpXHJcbiAgICAgICAgLm1hcCgocm93LCBpbmRleCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjaGFzc2lQYXRoID0gW1xyXG4gICAgICAgICAgICAgICAgcm93LlBvcCB8fCByb3cuUE9QLFxyXG4gICAgICAgICAgICAgICAgcm93LkNoYXNzaSxcclxuICAgICAgICAgICAgICAgIHJvdy5QbGFjYSxcclxuICAgICAgICAgICAgICAgIHJvdy5PTFQsXHJcbiAgICAgICAgICAgICAgICByb3cuQ3RvXHJcbiAgICAgICAgICAgIF0uZmlsdGVyKEJvb2xlYW4pLmpvaW4oJy8nKTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBpZDogU3RyaW5nKHJvdy5JZENhaXhhIHx8IGluZGV4KSxcclxuICAgICAgICAgICAgICAgIGN0bzogU3RyaW5nKHJvdy5DdG8gfHwgJycpLFxyXG4gICAgICAgICAgICAgICAgY2hhc3NpUGF0aCxcclxuICAgICAgICAgICAgICAgIGVuZGVyZWNvOiBTdHJpbmcocm93LkVuZGVyZWNvIHx8ICcnKSxcclxuICAgICAgICAgICAgICAgIGxhdDogcm93LkxhdCA/IHBhcnNlRmxvYXQoU3RyaW5nKHJvdy5MYXQpKSA6IG51bGwsXHJcbiAgICAgICAgICAgICAgICBsb25nOiByb3cuTG9uZyA/IHBhcnNlRmxvYXQoU3RyaW5nKHJvdy5Mb25nKSkgOiBudWxsLFxyXG4gICAgICAgICAgICAgICAgc3RhdHVzOiBTdHJpbmcocm93LlN0YXR1cyB8fCAnUGVuZGVudGUnKSxcclxuICAgICAgICAgICAgICAgIGRvbmU6IHJvdy5TdGF0dXMgPT09ICdPSydcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGlkOiBTdHJpbmcob3NSb3cuSWRPcyB8fCBvc1Jvdy5JRCB8fCBwb3ApLFxyXG4gICAgICAgIHBvcCxcclxuICAgICAgICBzdGF0dXM6IFN0cmluZyhvc1Jvdy5TdGF0dXNPcGVyYWNhbyB8fCAnJyksXHJcbiAgICAgICAgcHJvdG9jb2xvOiBTdHJpbmcob3NSb3cuUHJvdG9jb2xvIHx8ICcnKSxcclxuICAgICAgICBpdGVtc1xyXG4gICAgfTtcclxufVxyXG4iXSwibmFtZXMiOlsiWExTWCIsInJlYWRGaWxlIiwiQUxMT1dFRF9TVEFUVVNFUyIsIkVYQ0VMX1BBVEgiLCJwcm9jZXNzIiwiZW52IiwiQ0FDSEVfVFRMX01TIiwiY2FjaGUiLCJpc0NhY2hlVmFsaWQiLCJEYXRlIiwibm93IiwidGltZXN0YW1wIiwiaW52YWxpZGF0ZUV4Y2VsQ2FjaGUiLCJleGNlbERhdGVUb0pTIiwic2VyaWFsIiwiaXNOYU4iLCJ1dGNfZGF5cyIsIk1hdGgiLCJmbG9vciIsInV0Y192YWx1ZSIsImZvcm1hdEV4Y2VsRGF0ZSIsImRhdGUiLCJ0b0xvY2FsZURhdGVTdHJpbmciLCJTdHJpbmciLCJyZWFkRXhjZWxEYXRhIiwib3NEYXRhIiwiY2FpeGFEYXRhIiwiYnVmZmVyIiwid29ya2Jvb2siLCJyZWFkIiwidHlwZSIsIm9zU2hlZXQiLCJTaGVldHMiLCJ1dGlscyIsInNoZWV0X3RvX2pzb24iLCJjYWl4YVNoZWV0IiwiZ2V0RXhjZWxEYXRhIiwiZ2V0QWxsT1MiLCJtYXAiLCJyb3ciLCJvc0lkIiwiSWRPcyIsIklEIiwidG90YWxDYWl4YXMiLCJmaWx0ZXIiLCJjIiwiT1MiLCJsZW5ndGgiLCJpZCIsInBvcCIsIlBPUCIsIlBvcCIsInN0YXR1cyIsIlN0YXR1c09wZXJhY2FvIiwidHJpbSIsInVmIiwiVUYiLCJkYXRhRW50cmFudGUiLCJkYXRhUHJldkV4ZWMiLCJyYXdQcmV2RXhlYyIsImRhdGFDb25jbHVzYW8iLCJyYXdDb25jbHVzYW8iLCJjZW5hcmlvIiwiQ2VuYXJpbyIsInByb3RvY29sbyIsIlByb3RvY29sbyIsIm9zIiwicyIsInRvTG93ZXJDYXNlIiwic29ydCIsImEiLCJiIiwiZ2V0T1NCeUlkIiwib3NSb3ciLCJmaW5kIiwiaXRlbXMiLCJpbmRleCIsImNoYXNzaVBhdGgiLCJDaGFzc2kiLCJQbGFjYSIsIk9MVCIsIkN0byIsIkJvb2xlYW4iLCJqb2luIiwiSWRDYWl4YSIsImN0byIsImVuZGVyZWNvIiwiRW5kZXJlY28iLCJsYXQiLCJMYXQiLCJwYXJzZUZsb2F0IiwibG9uZyIsIkxvbmciLCJTdGF0dXMiLCJkb25lIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(action-browser)/./src/lib/excel.ts\n");

/***/ })

};
;