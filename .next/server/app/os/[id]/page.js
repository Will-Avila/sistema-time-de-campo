(()=>{var e={};e.id=979,e.ids=[979],e.modules={53524:e=>{"use strict";e.exports=require("@prisma/client")},47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6113:e=>{"use strict";e.exports=require("crypto")},73292:e=>{"use strict";e.exports=require("fs/promises")},71017:e=>{"use strict";e.exports=require("path")},53307:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>d.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>o,routeModule:()=>u,tree:()=>n});var s=a(50482),r=a(69108),l=a(62563),d=a.n(l),i=a(68300),c={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>i[e]);a.d(t,c);let n=["",{children:["os",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,58493)),"C:\\Programas\\PROJETOS\\sistema-time-de-campo\\src\\app\\os\\[id]\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,49223)),"C:\\Programas\\PROJETOS\\sistema-time-de-campo\\src\\app\\layout.tsx"],loading:[()=>Promise.resolve().then(a.bind(a,92793)),"C:\\Programas\\PROJETOS\\sistema-time-de-campo\\src\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,69361,23)),"next/dist/client/components/not-found-error"]}],o=["C:\\Programas\\PROJETOS\\sistema-time-de-campo\\src\\app\\os\\[id]\\page.tsx"],m="/os/[id]/page",x={require:a,loadChunk:()=>Promise.resolve()},u=new s.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/os/[id]/page",pathname:"/os/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:n}})},41102:(e,t,a)=>{let s={"2dd604a4fa171d5bf4edd119607f12882f2f1233":()=>Promise.resolve().then(a.bind(a,13398)).then(e=>e.getEquipes),"3a7a815bcde402ec80a76d4915ddaa24dd2697a6":()=>Promise.resolve().then(a.bind(a,13398)).then(e=>e.createEquipe),bb9004a81e2ec4420b2b97debd5f27e567e92ef6:()=>Promise.resolve().then(a.bind(a,13398)).then(e=>e.updateProfile),c5f7132601121f48314d1a51ecac279117f08ff6:()=>Promise.resolve().then(a.bind(a,13398)).then(e=>e.updatePreferences),c98ca564b4813ac5836f5e16d8b41e62d1cf9860:()=>Promise.resolve().then(a.bind(a,13398)).then(e=>e.deleteEquipe),e0bf2b8da39f29f7764053adebc46527dec3237e:()=>Promise.resolve().then(a.bind(a,13398)).then(e=>e.updateEquipe),"4f7cc3295bc1862da856a082439e474acd72ddb0":()=>Promise.resolve().then(a.bind(a,67778)).then(e=>e.logout),bbec7576f1f50640a4a678e3194e37400ea45963:()=>Promise.resolve().then(a.bind(a,67778)).then(e=>e.login),"22c53d6cc54bce46a621cc2c18c29a4b6151f7eb":()=>Promise.resolve().then(a.bind(a,36051)).then(e=>e.createNotification),"531833ed2258d48c2a40d41cd7d226d4ccc024cc":()=>Promise.resolve().then(a.bind(a,36051)).then(e=>e.markAsRead),"84b4112fe213bb4e51d524390b924583a28cf4a6":()=>Promise.resolve().then(a.bind(a,36051)).then(e=>e.getUnreadNotifications),a097c09bcedad3830c63ef8bf1297807d0616abc:()=>Promise.resolve().then(a.bind(a,36051)).then(e=>e.markAllAsRead),a6c151fc32852462d9c0091755251ef6cbbe43ba:()=>Promise.resolve().then(a.bind(a,5485)).then(e=>e.closeOS),aa1b8f78175846675a834f002e729602831a6bee:()=>Promise.resolve().then(a.bind(a,5485)).then(e=>e.deleteExecutionPhoto)};async function r(e,...t){return(await s[e]()).apply(null,t)}e.exports={"2dd604a4fa171d5bf4edd119607f12882f2f1233":r.bind(null,"2dd604a4fa171d5bf4edd119607f12882f2f1233"),"3a7a815bcde402ec80a76d4915ddaa24dd2697a6":r.bind(null,"3a7a815bcde402ec80a76d4915ddaa24dd2697a6"),bb9004a81e2ec4420b2b97debd5f27e567e92ef6:r.bind(null,"bb9004a81e2ec4420b2b97debd5f27e567e92ef6"),c5f7132601121f48314d1a51ecac279117f08ff6:r.bind(null,"c5f7132601121f48314d1a51ecac279117f08ff6"),c98ca564b4813ac5836f5e16d8b41e62d1cf9860:r.bind(null,"c98ca564b4813ac5836f5e16d8b41e62d1cf9860"),e0bf2b8da39f29f7764053adebc46527dec3237e:r.bind(null,"e0bf2b8da39f29f7764053adebc46527dec3237e"),"4f7cc3295bc1862da856a082439e474acd72ddb0":r.bind(null,"4f7cc3295bc1862da856a082439e474acd72ddb0"),bbec7576f1f50640a4a678e3194e37400ea45963:r.bind(null,"bbec7576f1f50640a4a678e3194e37400ea45963"),"22c53d6cc54bce46a621cc2c18c29a4b6151f7eb":r.bind(null,"22c53d6cc54bce46a621cc2c18c29a4b6151f7eb"),"531833ed2258d48c2a40d41cd7d226d4ccc024cc":r.bind(null,"531833ed2258d48c2a40d41cd7d226d4ccc024cc"),"84b4112fe213bb4e51d524390b924583a28cf4a6":r.bind(null,"84b4112fe213bb4e51d524390b924583a28cf4a6"),a097c09bcedad3830c63ef8bf1297807d0616abc:r.bind(null,"a097c09bcedad3830c63ef8bf1297807d0616abc"),a6c151fc32852462d9c0091755251ef6cbbe43ba:r.bind(null,"a6c151fc32852462d9c0091755251ef6cbbe43ba"),aa1b8f78175846675a834f002e729602831a6bee:r.bind(null,"aa1b8f78175846675a834f002e729602831a6bee")}},79818:(e,t,a)=>{Promise.resolve().then(a.t.bind(a,61476,23)),Promise.resolve().then(a.bind(a,22331)),Promise.resolve().then(a.bind(a,33851)),Promise.resolve().then(a.bind(a,85740))},56389:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(51091).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},69982:(e,t,a)=>{"use strict";a.d(t,{D:()=>r,_:()=>l}),a(13664);var s=a(28371),r=(0,s.$)("aa1b8f78175846675a834f002e729602831a6bee"),l=(0,s.$)("a6c151fc32852462d9c0091755251ef6cbbe43ba")},22331:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>j});var s=a(95344),r=a(81202),l=a(69982),d=a(3729),i=a(8428),c=a(23673),n=a(5094),o=a(2690),m=a(46540),x=a(56389),u=a(51091);let p=(0,u.Z)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),h=(0,u.Z)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var b=a(51765);let f=(0,u.Z)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var g=a(72032);function v(){let{pending:e}=(0,r.useFormStatus)();return s.jsx(n.z,{type:"submit",disabled:e,className:"w-full h-11 text-base",children:e?(0,s.jsxs)(s.Fragment,{children:[s.jsx(x.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Enviando..."]}):"Confirmar Encerramento"})}function j({osId:e,triggerClassName:t,triggerSize:a="sm"}){let[x,u]=(0,d.useState)(!1),j=(0,i.useRouter)(),N=(0,d.useRef)(null),[y,k]=(0,r.useFormState)(async(e,t)=>{let a=await (0,l._)(e,t);return a.success&&((0,g.A)("OS encerrada com sucesso!","success"),j.push("/os")),a},null);return(0,s.jsxs)(s.Fragment,{children:[s.jsx(n.z,{onClick:()=>u(!0),size:a,className:t||"shrink-0 text-sm font-semibold shadow-sm",children:"Encerrar OS"}),x&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-in fade-in duration-200",children:(0,s.jsxs)(c.Zb,{className:"w-full max-w-md overflow-hidden relative shadow-2xl dark:bg-slate-900 dark:border-slate-700",children:[s.jsx(c.Ol,{className:"bg-slate-50 dark:bg-slate-800 border-b dark:border-slate-700 pb-4",children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("h3",{className:"font-bold text-lg text-slate-900 dark:text-slate-100 flex items-center gap-2",children:[s.jsx(p,{className:"h-5 w-5 text-primary"}),"Encerrar Ordem de Servi\xe7o"]}),s.jsx("button",{onClick:()=>u(!1),className:"text-slate-400 hover:text-slate-600 dark:hover:text-slate-300",children:"âœ•"})]})}),s.jsx("div",{className:"p-6",children:(0,s.jsxs)("form",{ref:N,action:k,className:"space-y-5",children:[s.jsx("input",{type:"hidden",name:"osId",value:e}),(0,s.jsxs)("div",{className:"space-y-3",children:[s.jsx("label",{className:"text-sm font-medium leading-none text-slate-700 dark:text-slate-300",children:"Situa\xe7\xe3o Final"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("label",{className:"relative flex flex-col items-center justify-center p-4 border-2 rounded-xl cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-800 transition-all has-[:checked]:bg-primary/10 dark:has-[:checked]:bg-primary/20 has-[:checked]:border-primary has-[:checked]:text-primary",children:[s.jsx("input",{type:"radio",name:"status",value:"Conclu\xedda",className:"sr-only",defaultChecked:!0}),s.jsx(p,{className:"h-6 w-6 mb-2 text-slate-400"}),s.jsx("span",{className:"font-bold text-sm",children:"Conclu\xedda"})]}),(0,s.jsxs)("label",{className:"relative flex flex-col items-center justify-center p-4 border-2 rounded-xl cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-800 transition-all has-[:checked]:bg-red-50/50 dark:has-[:checked]:bg-red-900/30 has-[:checked]:border-destructive has-[:checked]:text-destructive",children:[s.jsx("input",{type:"radio",name:"status",value:"Sem Execu\xe7\xe3o",className:"sr-only"}),s.jsx(h,{className:"h-6 w-6 mb-2 text-slate-400"}),s.jsx("span",{className:"font-bold text-sm",children:"N\xe3o Executada"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium leading-none text-slate-700 dark:text-slate-300",children:"Observa\xe7\xf5es"}),s.jsx(o.g,{name:"obs",placeholder:"Descreva os detalhes do servi\xe7o realizado, materiais utilizados, etc..."})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("label",{className:"text-sm font-medium leading-none text-slate-700 dark:text-slate-300 flex items-center gap-2",children:[s.jsx(b.Z,{className:"h-4 w-4"}),"Fotos do Servi\xe7o"]}),s.jsx(m.I,{type:"file",name:"photos",multiple:!0,accept:"image/*",className:"cursor-pointer file:cursor-pointer file:text-primary file:bg-primary/10 file:mr-4 file:py-1 file:px-2 file:rounded-full file:border-0 file:text-xs file:font-semibold h-auto py-2"})]}),y?.message&&(0,s.jsxs)("div",{className:`p-4 rounded-lg text-sm flex items-center gap-3 ${y.success?"bg-green-50 text-green-800 border border-green-200":"bg-destructive/10 text-destructive border border-destructive/20"}`,children:[y.success?s.jsx(p,{className:"h-5 w-5"}):s.jsx(f,{className:"h-5 w-5"}),y.message]}),(0,s.jsxs)("div",{className:"flex gap-4 pt-2",children:[s.jsx(n.z,{type:"button",variant:"outline",onClick:()=>u(!1),className:"flex-1 h-11 dark:border-slate-600 dark:text-slate-300",children:"Cancelar"}),s.jsx("div",{className:"flex-1",children:s.jsx(v,{})})]})]})})]})})]})}},33851:(e,t,a)=>{"use strict";a.r(t),a.d(t,{OSPhotosGallery:()=>m});var s=a(95344),r=a(3729),l=a(89410),d=a(3923),i=a(30026),c=a(38271),n=a(69982),o=a(72032);function m({photos:e,osId:t,allowDelete:a=!1}){let[m,x]=(0,r.useState)(!1),[u,p]=(0,r.useState)(0),[h,b]=(0,r.useState)(!1),[f,g]=(0,r.useState)(null);async function v(e){g(null),b(!0);let a=await (0,n.D)(e,t);a.success?(0,o.A)("Foto removida.","success"):(0,o.A)(a.message||"Erro ao remover foto.","error"),b(!1)}return 0===e.length?null:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{children:[s.jsx("span",{className:"text-xs font-semibold text-muted-foreground uppercase tracking-wide mb-2 block",children:"Evid\xeancias Fotogr\xe1ficas"}),s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2",children:e.map((e,t)=>(0,s.jsxs)("div",{className:"relative aspect-square group rounded-lg overflow-hidden border border-slate-200 dark:border-slate-800 cursor-pointer",onClick:()=>{p(t),x(!0)},children:[s.jsx(l.default,{src:e.path,alt:"Evid\xeancia",fill:!0,className:"object-cover transition-transform hover:scale-105"}),a&&s.jsx("button",{onClick:t=>{var a;t.preventDefault(),t.stopPropagation(),a=e.id,g({title:"Excluir Foto",message:"Tem certeza que deseja apagar esta foto permanently? Esta a\xe7\xe3o n\xe3o pode ser desfeita.",action:()=>v(a)})},className:"absolute top-1 right-1 bg-red-500/80 text-white p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600 z-10",title:"Excluir foto",disabled:h,children:s.jsx(c.Z,{className:"h-3 w-3"})})]},e.id))})]}),s.jsx(d.O,{isOpen:m,onClose:()=>x(!1),images:e.map(e=>e.path),initialIndex:u}),s.jsx(i.s,{open:!!f,title:f?.title||"",message:f?.message||"",variant:"danger",confirmLabel:"Sim, excluir",onConfirm:()=>f?.action(),onCancel:()=>g(null)})]})}},29003:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(12589).Z)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},5485:(e,t,a)=>{"use strict";a.r(t),a.d(t,{closeOS:()=>h,deleteExecutionPhoto:()=>b});var s=a(98601);a(75811);var r=a(32870),l=a(50841),d=a(43811),i=a(68474),c=a(19961),n=a(73292),o=a(71017),m=a.n(o),x=a(46893);let u=["image/jpeg","image/jpg","image/png","image/webp"],p=r.z.object({osId:r.z.preprocess(e=>e??"",r.z.string().min(1,"osId obrigat\xf3rio")),status:r.z.preprocess(e=>e??"",r.z.enum(["Conclu\xedda","Sem Execu\xe7\xe3o"],{errorMap:()=>({message:"Status inv\xe1lido"})})),obs:r.z.preprocess(e=>e??"",r.z.string().default(""))});async function h(e,t){let s=await (0,i.requireAuth)().catch(()=>null);if(!s)return{success:!1,message:"N\xe3o autenticado."};let r=s.id,o=p.safeParse({osId:t.get("osId"),status:t.get("status"),obs:t.get("obs")});if(!o.success)return{success:!1,message:"Dados inv\xe1lidos: "+o.error.issues.map(e=>e.message).join(", ")};let{osId:x,status:h,obs:b}=o.data,f=t.getAll("photos");try{let e=await l.prisma.equipe.findUnique({where:{id:r},select:{name:!0,fullName:!0,nomeEquipe:!0}}),t=e?.fullName||e?.nomeEquipe||e?.name||"Equipe",s=await l.prisma.serviceExecution.findFirst({where:{osId:x}});if(s=s?await l.prisma.serviceExecution.update({where:{id:s.id},data:{equipeId:r,technicianName:t,status:"DONE",obs:`Status: ${h}
${b}`}}):await l.prisma.serviceExecution.create({data:{osId:x,equipeId:r,technicianName:t,status:"DONE",power:"",obs:`Status: ${h}
${b}`}}),f.length>0&&f[0].size>0){let{getOSById:e}=await Promise.resolve().then(a.bind(a,69260)),t=await e(x),r=t?.protocolo||"SEM_PROTOCOLO",d=process.env.PHOTOS_PATH||"C:\\Programas\\PROJETOS\\fotos",i=m().join(d,r);for(let e of(await (0,n.mkdir)(i,{recursive:!0}),f)){if(e.size>5242880||!u.includes(e.type))continue;let t=Buffer.from(await e.arrayBuffer()),a=e.name.replace(/[^a-zA-Z0-9.-]/g,"_"),d=`${Date.now()}-${a}`,c=m().join(i,d);await (0,n.writeFile)(c,t),await l.prisma.photo.create({data:{executionId:s.id,path:`/api/images/${r}/${d}`}})}}(0,d.revalidatePath)(`/os/${x}`),(0,d.revalidatePath)("/os"),(0,d.revalidatePath)("/admin/dashboard");let{createNotification:i}=await Promise.resolve().then(a.bind(a,36051)),{getOSById:c}=await Promise.resolve().then(a.bind(a,69260)),o=await c(x),p=o?.protocolo||x;return await i({type:"OS_CLOSE",title:"OS Encerrada",message:`${t} encerrou a OS ${p}. Status: ${h}`,equipeId:r,technicianName:t,osId:x}),{success:!0,message:"OS encerrada com sucesso!"}}catch(e){return c.logger.error("Error closing OS",{error:String(e)}),{success:!1,message:"Erro ao salvar OS. Tente novamente."}}}async function b(e,t){if(!await (0,i.requireAuth)().catch(()=>null))return{success:!1,message:"N\xe3o autenticado."};try{let s=await l.prisma.photo.findUnique({where:{id:e}});if(!s)return{success:!1,message:"Foto n\xe3o encontrada."};let r="";if(s.path.startsWith("/api/images/")){let e=s.path.replace("/api/images/","");r=m().join(process.env.PHOTOS_PATH||"C:\\Programas\\PROJETOS\\fotos",e)}else r=m().join(process.cwd(),"public",s.path);try{await Promise.resolve().then(a.t.bind(a,73292,23)).then(e=>e.unlink(r))}catch(e){c.logger.warn("Error deleting file (might be missing)",{error:String(e)})}return await l.prisma.photo.delete({where:{id:e}}),(0,d.revalidatePath)(`/os/${t}`),{success:!0,message:"Foto removida."}}catch(e){return c.logger.error("Error deleting photo",{error:String(e)}),{success:!1,message:"Erro ao remover foto."}}}(0,x.ensureServerEntryExports)([h,b]),(0,s.createActionProxy)("a6c151fc32852462d9c0091755251ef6cbbe43ba",h),(0,s.createActionProxy)("aa1b8f78175846675a834f002e729602831a6bee",b)},58493:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>_});var s=a(25036),r=a(85843),l=a(81494),d=a(867),i=a(16274),c=a(26540),n=a(12589);let o=(0,n.Z)("building",[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]]),m=(0,n.Z)("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);var x=a(66705);let u=(0,n.Z)("map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]),p=(0,n.Z)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),h=(0,n.Z)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);var b=a(29003);let f=(0,n.Z)("paperclip",[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]]),g=(0,n.Z)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);var v=a(13067),j=a(72245),N=a(86843);let y=(0,N.createProxy)(String.raw`C:\Programas\PROJETOS\sistema-time-de-campo\src\app\os\[id]\OSClosureForm.tsx`),{__esModule:k,$$typeof:w}=y,P=y.default,O=(0,N.createProxy)(String.raw`C:\Programas\PROJETOS\sistema-time-de-campo\src\app\os\[id]\OSPhotosGallery.tsx`),{__esModule:E,$$typeof:S}=O;O.default;let C=(0,N.createProxy)(String.raw`C:\Programas\PROJETOS\sistema-time-de-campo\src\app\os\[id]\OSPhotosGallery.tsx#OSPhotosGallery`);var q=a(74801),z=a(38052),M=a(44551),Z=a(31842),A=a(55379),R=a(34279);async function _({params:e}){let t=await (0,r.ho)(e.id),a=await (0,A.getSession)(),n=a?.isAdmin;if(!t)return(0,d.notFound)();let N=await l._.serviceExecution.findFirst({where:{osId:t.id},include:{equipe:!0,photos:!0}}),y=(0,j.x)({osStatus:t.status,execution:N});return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-slate-950 pb-20 transition-colors",children:[s.jsx(q.c,{}),(0,s.jsxs)("div",{className:"pt-24 px-4 md:px-8 max-w-4xl mx-auto space-y-6",children:[(0,s.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[s.jsx(i.default,{href:"/os",className:"p-2 -ml-2 hover:bg-slate-200 dark:hover:bg-slate-800 rounded-full transition-colors",children:s.jsx(c.Z,{className:"h-6 w-6 text-slate-700 dark:text-slate-300"})}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(Z.C,{variant:"outline",className:"font-mono text-xs text-muted-foreground border-slate-200 dark:border-slate-700",children:t.protocolo}),t.uf&&s.jsx(Z.C,{variant:"secondary",className:"text-[10px] h-5 px-1.5 font-bold bg-slate-100 text-slate-600 dark:bg-slate-800 dark:text-slate-300",children:t.uf})]}),t.condominio&&(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-0.5 mt-1",children:[s.jsx(o,{className:"h-4 w-4 text-slate-500"}),s.jsx("span",{className:"text-sm font-bold text-slate-600 dark:text-slate-300 uppercase tracking-wide",children:t.condominio})]}),s.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-slate-900 dark:text-slate-100",children:t.pop}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-2 mt-2",children:[s.jsx(R.O,{osStatus:t.status,execution:N}),(0,s.jsxs)(Z.C,{variant:"outline",className:"text-slate-500 bg-white/50 dark:bg-slate-900/50",children:[t.items.length," caixas"]})]})]})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 w-full md:w-auto",children:[n&&s.jsx(i.default,{href:`/os/${t.id}/admin`,children:(0,s.jsxs)(z.z,{variant:"outline",size:"lg",className:"w-full gap-2 border-slate-300 dark:border-slate-700 hover:bg-slate-100 dark:hover:bg-slate-800",children:[s.jsx(m,{className:"h-4 w-4"}),"Editar Info."]})}),s.jsx(i.default,{href:`/os/${t.id}/execution`,className:"w-full sm:w-auto",children:(0,s.jsxs)(z.z,{size:"lg",className:"w-full gap-2 shadow-lg bg-blue-600 hover:bg-blue-700",children:[s.jsx(x.Z,{className:"h-4 w-4"}),"CAIXAS"]})}),(!N||"DONE"!==N.status)&&!y.label.includes("Conclu\xedda")&&!y.label.includes("Encerrada")&&!y.label.includes("Cancelada")&&s.jsx(P,{osId:t.id,triggerClassName:"w-full sm:w-auto h-11 px-8 gap-2 shadow-lg bg-red-600 hover:bg-red-700 text-white inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",triggerSize:"lg"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)(M.Zb,{className:"shadow-sm",children:[s.jsx(M.Ol,{className:"pb-3 border-b border-slate-100 dark:border-slate-800",children:(0,s.jsxs)(M.ll,{className:"text-base font-semibold flex items-center gap-2 text-slate-800 dark:text-slate-200",children:[s.jsx(m,{className:"h-4 w-4 text-blue-500"}),"Informa\xe7\xf5es Principais"]})}),(0,s.jsxs)(M.aY,{className:"pt-4 space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[s.jsx("span",{className:"text-xs font-semibold text-muted-foreground/60 uppercase tracking-wider text-[10px]",children:"POP"}),s.jsx("p",{className:"text-sm font-medium text-slate-900 dark:text-slate-100 mt-0.5",children:t.pop})]}),(0,s.jsxs)("div",{children:[s.jsx("span",{className:"text-xs font-semibold text-muted-foreground/60 uppercase tracking-wider text-[10px]",children:"Protocolo"}),s.jsx("p",{className:"text-sm font-medium text-slate-900 dark:text-slate-100 mt-0.5 font-mono",children:t.protocolo})]})]}),(0,s.jsxs)("div",{children:[s.jsx("span",{className:"text-xs font-semibold text-muted-foreground/60 uppercase tracking-wider text-[10px]",children:"Cen\xe1rio"}),(0,s.jsxs)("div",{className:"flex items-start gap-2 mt-1",children:[s.jsx(u,{className:"h-4 w-4 text-slate-400 mt-0.5 shrink-0"}),s.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300",children:t.cenario||"N\xe3o especificado"})]})]}),t.condominio&&(0,s.jsxs)("div",{children:[s.jsx("span",{className:"text-xs font-semibold text-muted-foreground/60 uppercase tracking-wider text-[10px]",children:"Condom\xednio"}),(0,s.jsxs)("div",{className:"flex items-start gap-2 mt-1",children:[s.jsx(o,{className:"h-4 w-4 text-slate-400 mt-0.5 shrink-0"}),s.jsx("p",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:t.condominio})]})]}),N?.equipe&&(0,s.jsxs)("div",{className:"pt-2 border-t border-slate-100 dark:border-slate-800 mt-2",children:[s.jsx("span",{className:"text-xs font-semibold text-muted-foreground/60 uppercase tracking-wider text-[10px]",children:"Equipe Respons\xe1vel"}),(0,s.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[s.jsx(p,{className:"h-4 w-4 text-slate-400"}),s.jsx("p",{className:"text-sm font-medium text-slate-900 dark:text-slate-100",children:N.equipe.fullName||N.equipe.nomeEquipe||N.equipe.name})]})]})]})]}),(0,s.jsxs)(M.Zb,{className:"shadow-sm",children:[s.jsx(M.Ol,{className:"pb-3 border-b border-slate-100 dark:border-slate-800",children:(0,s.jsxs)(M.ll,{className:"text-base font-semibold flex items-center gap-2 text-slate-800 dark:text-slate-200",children:[s.jsx(h,{className:"h-4 w-4 text-violet-500"}),"Prazos e Datas"]})}),s.jsx(M.aY,{className:"pt-4 space-y-5",children:(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-y-5 gap-x-4",children:[(0,s.jsxs)("div",{children:[s.jsx("span",{className:"block text-muted-foreground/60 mb-1 text-[10px] uppercase font-bold tracking-wider",children:"Entrada"}),(0,s.jsxs)("div",{className:"flex items-center gap-1.5 font-medium text-slate-700 dark:text-slate-300",children:[s.jsx(h,{className:"h-3.5 w-3.5 text-slate-400"}),t.dataEntrante]})]}),"Conclu\xedda"===y.label?(0,s.jsxs)("div",{children:[s.jsx("span",{className:"block text-muted-foreground/60 mb-1 text-[10px] uppercase font-bold tracking-wider",children:"Conclus\xe3o"}),(0,s.jsxs)("div",{className:"flex items-center gap-1.5 font-medium text-slate-700 dark:text-slate-300",children:[s.jsx(h,{className:"h-3.5 w-3.5 text-slate-400"}),N?.updatedAt?N.updatedAt.toLocaleDateString("pt-BR"):t.dataConclusao||"-"]})]}):(0,s.jsxs)("div",{children:[s.jsx("span",{className:"block text-muted-foreground/60 mb-1 text-[10px] uppercase font-bold tracking-wider",children:"Prazo"}),(0,s.jsxs)("div",{className:`flex items-center gap-1.5 font-medium ${(e=>{if(!e||"-"===e)return"text-slate-700 dark:text-slate-300";let[t,a,s]=e.split("/").map(Number),r=new Date(s,a-1,t),l=new Date,d=new Date(r.getFullYear(),r.getMonth(),r.getDate()),i=new Date(l.getFullYear(),l.getMonth(),l.getDate());return d.getTime()<i.getTime()?"text-rose-600 dark:text-rose-400":d.getTime()===i.getTime()?"text-amber-600 dark:text-amber-400":"text-slate-700 dark:text-slate-300"})(t.dataPrevExec)}`,children:[s.jsx(h,{className:"h-3.5 w-3.5 text-slate-400 opacity-70"}),t.dataPrevExec]})]}),(0,s.jsxs)("div",{children:[s.jsx("span",{className:"block text-muted-foreground/60 mb-1 text-[10px] uppercase font-bold tracking-wider",children:"Total Caixas"}),(0,s.jsxs)("div",{className:"flex items-center gap-1.5 font-medium text-slate-700 dark:text-slate-300",children:[s.jsx(x.Z,{className:"h-3.5 w-3.5 text-slate-400"}),t.items.length," CTOs"]})]}),(0,s.jsxs)("div",{children:[s.jsx("span",{className:"block text-muted-foreground/60 mb-1 text-[10px] uppercase font-bold tracking-wider",children:"UF"}),(0,s.jsxs)("div",{className:"flex items-center gap-1.5 font-medium text-slate-700 dark:text-slate-300",children:[s.jsx(b.Z,{className:"h-3.5 w-3.5 text-slate-400"}),t.uf||"-"]})]})]})})]}),(t.descricao||t.anexos&&t.anexos.length>0)&&(0,s.jsxs)(M.Zb,{className:"shadow-sm border-l-4 border-l-violet-500 md:col-span-2",children:[s.jsx(M.Ol,{className:"pb-3 border-b border-slate-100 dark:border-slate-800",children:(0,s.jsxs)(M.ll,{className:"text-base font-semibold flex items-center gap-2 text-slate-800 dark:text-slate-200",children:[s.jsx(m,{className:"h-4 w-4 text-violet-500"}),"Informa\xe7\xf5es Adicionais"]})}),(0,s.jsxs)(M.aY,{className:"pt-4 space-y-4",children:[t.descricao&&(0,s.jsxs)("div",{children:[s.jsx("span",{className:"text-xs font-semibold text-muted-foreground/60 uppercase tracking-wider text-[10px]",children:"Descri\xe7\xe3o"}),s.jsx("p",{className:"mt-1 text-sm text-slate-700 dark:text-slate-300 whitespace-pre-wrap",children:t.descricao})]}),t.anexos&&t.anexos.length>0&&(0,s.jsxs)("div",{className:t.descricao?"pt-4 border-t border-slate-100 dark:border-slate-800":"",children:[s.jsx("span",{className:"text-xs font-semibold text-muted-foreground/60 uppercase tracking-wider text-[10px]",children:"Anexos"}),s.jsx("div",{className:"mt-2 grid grid-cols-1 gap-2",children:t.anexos.map(e=>(0,s.jsxs)("a",{href:e.path,download:!0,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-between p-2.5 bg-slate-50 dark:bg-slate-900 rounded-lg border border-slate-200 dark:border-slate-800 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors group",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 overflow-hidden",children:[s.jsx(f,{className:"h-4 w-4 text-slate-400 group-hover:text-violet-500 transition-colors"}),s.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 truncate",children:e.name}),(0,s.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(",(e.size/1024).toFixed(0)," KB)"]})]}),s.jsx(g,{className:"h-4 w-4 text-slate-400 group-hover:text-slate-700 dark:group-hover:text-slate-200"})]},e.id))})]})]})]}),N&&"DONE"===N.status&&(0,s.jsxs)(M.Zb,{className:"shadow-sm md:col-span-2 border-l-4 border-l-slate-300 dark:border-l-slate-700",children:[s.jsx(M.Ol,{className:"pb-3 border-b border-slate-100 dark:border-slate-800",children:(0,s.jsxs)(M.ll,{className:"text-base font-semibold flex items-center gap-2 text-slate-800 dark:text-slate-200",children:[s.jsx(v.Z,{className:"h-4 w-4 text-slate-400"}),"Detalhes do Encerramento (Respons\xe1vel)",N.updatedAt&&s.jsx("span",{className:"ml-auto text-xs font-normal text-muted-foreground",children:N.updatedAt.toLocaleString("pt-BR")})]})}),(0,s.jsxs)(M.aY,{className:"pt-4 space-y-4",children:[(0,s.jsxs)("div",{children:[s.jsx("span",{className:"text-xs font-semibold text-muted-foreground uppercase tracking-wide",children:"Observa\xe7\xe3o"}),s.jsx("div",{className:"mt-1 p-3 bg-slate-50 dark:bg-slate-900 rounded-lg text-sm text-slate-700 dark:text-slate-300 whitespace-pre-wrap border border-slate-100 dark:border-slate-800",children:N.obs||"Nenhuma observa\xe7\xe3o."})]}),N.photos.filter(e=>!e.caixaId).length>0&&s.jsx(C,{photos:N.photos.filter(e=>!e.caixaId),osId:t.id,allowDelete:!0})]})]})]})]})]})}},34279:(e,t,a)=>{"use strict";a.d(t,{O:()=>o});var s=a(25036);a(40002);var r=a(31842),l=a(72245),d=a(67821),i=a(13067),c=a(81389),n=a(66705);function o({label:e,osStatus:t,execution:a,className:o,showIcon:m=!0}){let x=e,u="secondary",p=d.Z;if(e){x=e,u=(0,l.A)(e);let t=e.toLowerCase();t.includes("conclu\xed")||t.includes("conclui")||t.includes("encerrada")?p=i.Z:t.includes("an\xe1lise")||t.includes("analise")?p=c.Z:(t.includes("execu\xe7\xe3o")||t.includes("execucao"))&&(p=n.Z)}else if(void 0!==t){let e=(0,l.x)({osStatus:t,execution:a});x=e.label,u=e.variant,p=e.icon}return(0,s.jsxs)(r.C,{variant:u,className:o,children:[m&&s.jsx(p,{className:"mr-1.5 h-3.5 w-3.5"}),x]})}},31842:(e,t,a)=>{"use strict";a.d(t,{C:()=>l});var s=a(25036);a(40002);var r=a(72245);function l({className:e,variant:t="default",...a}){return s.jsx("div",{className:(0,r.cn)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",success:"border-emerald-500/50 bg-transparent text-emerald-600 dark:text-emerald-400 dark:border-emerald-500/30",warning:"border-transparent bg-yellow-500 text-white hover:bg-yellow-600",orange:"border-transparent bg-orange-500 text-white hover:bg-orange-600","light-green":"border-emerald-500/30 bg-transparent text-emerald-600 dark:text-emerald-400/80 dark:border-emerald-500/20"}[t],e),...a})}},38052:(e,t,a)=>{"use strict";a.d(t,{z:()=>d});var s=a(25036),r=a(40002),l=a(72245);let d=r.forwardRef(({className:e,variant:t="default",size:a="default",...r},d)=>s.jsx("button",{className:(0,l.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"}[t],{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}[a],e),ref:d,...r}));d.displayName="Button"},44551:(e,t,a)=>{"use strict";a.d(t,{Ol:()=>i,SZ:()=>n,Zb:()=>d,aY:()=>o,ll:()=>c});var s=a(25036),r=a(40002),l=a(72245);let d=r.forwardRef(({className:e,...t},a)=>s.jsx("div",{ref:a,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));d.displayName="Card";let i=r.forwardRef(({className:e,...t},a)=>s.jsx("div",{ref:a,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",e),...t}));i.displayName="CardHeader";let c=r.forwardRef(({className:e,...t},a)=>s.jsx("h3",{ref:a,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));c.displayName="CardTitle";let n=r.forwardRef(({className:e,...t},a)=>s.jsx("p",{ref:a,className:(0,l.cn)("text-sm text-muted-foreground",e),...t}));n.displayName="CardDescription";let o=r.forwardRef(({className:e,...t},a)=>s.jsx("div",{ref:a,className:(0,l.cn)("p-6 pt-0",e),...t}));o.displayName="CardContent",r.forwardRef(({className:e,...t},a)=>s.jsx("div",{ref:a,className:(0,l.cn)("flex items-center p-6 pt-0",e),...t})).displayName="CardFooter"}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[893,402,235,722,341,867,528,163,213,268],()=>a(53307));module.exports=s})();