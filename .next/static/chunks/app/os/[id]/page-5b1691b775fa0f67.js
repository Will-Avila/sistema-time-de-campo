(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[979],{6108:function(e,t,s){Promise.resolve().then(s.t.bind(s,5250,23)),Promise.resolve().then(s.bind(s,9956)),Promise.resolve().then(s.bind(s,2913)),Promise.resolve().then(s.bind(s,4861))},9580:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(4999).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},5160:function(e,t,s){"use strict";s.d(t,{D:function(){return a},_:function(){return l}}),s(5355);var r=s(3472),a=(0,r.$)("aa1b8f78175846675a834f002e729602831a6bee"),l=(0,r.$)("a6c151fc32852462d9c0091755251ef6cbbe43ba")},9956:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return j}});var r=s(3827),a=s(9542),l=s(5160),n=s(4090),i=s(7907),c=s(5671),o=s(575),d=s(3549),u=s(2782),m=s(9580),f=s(4999);let x=(0,f.Z)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),h=(0,f.Z)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var b=s(7336);let p=(0,f.Z)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var g=s(7290);function v(){let{pending:e}=(0,a.useFormStatus)();return(0,r.jsx)(o.z,{type:"submit",disabled:e,className:"w-full h-11 text-base",children:e?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Enviando..."]}):"Confirmar Encerramento"})}function j(e){let{osId:t,triggerClassName:s,triggerSize:m="sm"}=e,[f,j]=(0,n.useState)(!1),k=(0,i.useRouter)(),N=(0,n.useRef)(null),[y,w]=(0,a.useFormState)(async(e,t)=>{let s=await (0,l._)(e,t);return s.success&&((0,g.A)("OS encerrada com sucesso!","success"),k.push("/os")),s},null);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.z,{onClick:()=>j(!0),size:m,className:s||"shrink-0 text-sm font-semibold shadow-sm",children:"Encerrar OS"}),f&&(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-in fade-in duration-200",children:(0,r.jsxs)(c.Zb,{className:"w-full max-w-md overflow-hidden relative shadow-2xl dark:bg-slate-900 dark:border-slate-700",children:[(0,r.jsx)(c.Ol,{className:"bg-slate-50 dark:bg-slate-800 border-b dark:border-slate-700 pb-4",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("h3",{className:"font-bold text-lg text-slate-900 dark:text-slate-100 flex items-center gap-2",children:[(0,r.jsx)(x,{className:"h-5 w-5 text-primary"}),"Encerrar Ordem de Servi\xe7o"]}),(0,r.jsx)("button",{onClick:()=>j(!1),className:"text-slate-400 hover:text-slate-600 dark:hover:text-slate-300",children:"âœ•"})]})}),(0,r.jsx)("div",{className:"p-6",children:(0,r.jsxs)("form",{ref:N,action:w,className:"space-y-5",children:[(0,r.jsx)("input",{type:"hidden",name:"osId",value:t}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("label",{className:"text-sm font-medium leading-none text-slate-700 dark:text-slate-300",children:"Situa\xe7\xe3o Final"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("label",{className:"relative flex flex-col items-center justify-center p-4 border-2 rounded-xl cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-800 transition-all has-[:checked]:bg-primary/10 dark:has-[:checked]:bg-primary/20 has-[:checked]:border-primary has-[:checked]:text-primary",children:[(0,r.jsx)("input",{type:"radio",name:"status",value:"Conclu\xedda",className:"sr-only",defaultChecked:!0}),(0,r.jsx)(x,{className:"h-6 w-6 mb-2 text-slate-400"}),(0,r.jsx)("span",{className:"font-bold text-sm",children:"Conclu\xedda"})]}),(0,r.jsxs)("label",{className:"relative flex flex-col items-center justify-center p-4 border-2 rounded-xl cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-800 transition-all has-[:checked]:bg-red-50/50 dark:has-[:checked]:bg-red-900/30 has-[:checked]:border-destructive has-[:checked]:text-destructive",children:[(0,r.jsx)("input",{type:"radio",name:"status",value:"Sem Execu\xe7\xe3o",className:"sr-only"}),(0,r.jsx)(h,{className:"h-6 w-6 mb-2 text-slate-400"}),(0,r.jsx)("span",{className:"font-bold text-sm",children:"N\xe3o Executada"})]})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-sm font-medium leading-none text-slate-700 dark:text-slate-300",children:"Observa\xe7\xf5es"}),(0,r.jsx)(d.g,{name:"obs",placeholder:"Descreva os detalhes do servi\xe7o realizado, materiais utilizados, etc..."})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("label",{className:"text-sm font-medium leading-none text-slate-700 dark:text-slate-300 flex items-center gap-2",children:[(0,r.jsx)(b.Z,{className:"h-4 w-4"}),"Fotos do Servi\xe7o"]}),(0,r.jsx)(u.I,{type:"file",name:"photos",multiple:!0,accept:"image/*",className:"cursor-pointer file:cursor-pointer file:text-primary file:bg-primary/10 file:mr-4 file:py-1 file:px-2 file:rounded-full file:border-0 file:text-xs file:font-semibold h-auto py-2"})]}),(null==y?void 0:y.message)&&(0,r.jsxs)("div",{className:"p-4 rounded-lg text-sm flex items-center gap-3 ".concat(y.success?"bg-green-50 text-green-800 border border-green-200":"bg-destructive/10 text-destructive border border-destructive/20"),children:[y.success?(0,r.jsx)(x,{className:"h-5 w-5"}):(0,r.jsx)(p,{className:"h-5 w-5"}),y.message]}),(0,r.jsxs)("div",{className:"flex gap-4 pt-2",children:[(0,r.jsx)(o.z,{type:"button",variant:"outline",onClick:()=>j(!1),className:"flex-1 h-11 dark:border-slate-600 dark:text-slate-300",children:"Cancelar"}),(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsx)(v,{})})]})]})})]})})]})}},2913:function(e,t,s){"use strict";s.r(t),s.d(t,{OSPhotosGallery:function(){return u}});var r=s(3827),a=s(4090),l=s(703),n=s(2685),i=s(5369),c=s(489),o=s(5160),d=s(7290);function u(e){let{photos:t,osId:s,allowDelete:u=!1}=e,[m,f]=(0,a.useState)(!1),[x,h]=(0,a.useState)(0),[b,p]=(0,a.useState)(!1),[g,v]=(0,a.useState)(null);async function j(e){v(null),p(!0);let t=await (0,o.D)(e,s);t.success?(0,d.A)("Foto removida.","success"):(0,d.A)(t.message||"Erro ao remover foto.","error"),p(!1)}return 0===t.length?null:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-xs font-semibold text-muted-foreground uppercase tracking-wide mb-2 block",children:"Evid\xeancias Fotogr\xe1ficas"}),(0,r.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2",children:t.map((e,t)=>(0,r.jsxs)("div",{className:"relative aspect-square group rounded-lg overflow-hidden border border-slate-200 dark:border-slate-800 cursor-pointer",onClick:()=>{h(t),f(!0)},children:[(0,r.jsx)(l.default,{src:e.path,alt:"Evid\xeancia",fill:!0,className:"object-cover transition-transform hover:scale-105"}),u&&(0,r.jsx)("button",{onClick:t=>{var s;t.preventDefault(),t.stopPropagation(),s=e.id,v({title:"Excluir Foto",message:"Tem certeza que deseja apagar esta foto permanently? Esta a\xe7\xe3o n\xe3o pode ser desfeita.",action:()=>j(s)})},className:"absolute top-1 right-1 bg-red-500/80 text-white p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600 z-10",title:"Excluir foto",disabled:b,children:(0,r.jsx)(c.Z,{className:"h-3 w-3"})})]},e.id))})]}),(0,r.jsx)(n.O,{isOpen:m,onClose:()=>f(!1),images:t.map(e=>e.path),initialIndex:x}),(0,r.jsx)(i.s,{open:!!g,title:(null==g?void 0:g.title)||"",message:(null==g?void 0:g.message)||"",variant:"danger",confirmLabel:"Sim, excluir",onConfirm:()=>null==g?void 0:g.action(),onCancel:()=>v(null)})]})}},5671:function(e,t,s){"use strict";s.d(t,{Ol:function(){return i},SZ:function(){return o},Zb:function(){return n},aY:function(){return d},eW:function(){return u},ll:function(){return c}});var r=s(3827),a=s(4090),l=s(2169);let n=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...a})});n.displayName="Card";let i=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",s),...a})});i.displayName="CardHeader";let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("h3",{ref:t,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",s),...a})});c.displayName="CardTitle";let o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("p",{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",s),...a})});o.displayName="CardDescription";let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("p-6 pt-0",s),...a})});d.displayName="CardContent";let u=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",s),...a})});u.displayName="CardFooter"},5369:function(e,t,s){"use strict";s.d(t,{s:function(){return i}});var r=s(3827),a=s(5671),l=s(575),n=s(9724);function i(e){let{open:t,title:s,message:i,confirmLabel:c="Confirmar",cancelLabel:o="Cancelar",variant:d="default",onConfirm:u,onCancel:m}=e;return t?(0,r.jsx)("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-in fade-in duration-200",children:(0,r.jsx)(a.Zb,{className:"w-full max-w-sm shadow-2xl dark:bg-slate-900 dark:border-slate-700",children:(0,r.jsxs)("div",{className:"p-6 space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)("div",{className:"p-2 rounded-full shrink-0 ".concat("danger"===d?"bg-red-100 dark:bg-red-900/30":"bg-blue-100 dark:bg-blue-900/30"),children:(0,r.jsx)(n.Z,{className:"h-5 w-5 ".concat("danger"===d?"text-red-600 dark:text-red-400":"text-blue-600 dark:text-blue-400")})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-bold text-slate-900 dark:text-slate-100",children:s}),(0,r.jsx)("p",{className:"text-sm text-slate-600 dark:text-slate-400 mt-1",children:i})]})]}),(0,r.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,r.jsx)(l.z,{variant:"outline",onClick:m,className:"dark:border-slate-600 dark:text-slate-300",children:o}),(0,r.jsx)(l.z,{variant:"danger"===d?"destructive":"default",onClick:u,children:c})]})]})})}):null}},2685:function(e,t,s){"use strict";s.d(t,{O:function(){return d}});var r=s(3827),a=s(2235),l=s(9108),n=s(7805),i=s(703),c=s(4090),o=s(9542);function d(e){let{isOpen:t,onClose:s,images:d,initialIndex:u=0}=e,[m,f]=c.useState(u);(0,c.useEffect)(()=>{t&&f(u)},[t,u]);let x=(0,c.useCallback)(()=>{f(e=>(e+1)%d.length)},[d.length]),h=(0,c.useCallback)(()=>{f(e=>(e-1+d.length)%d.length)},[d.length]);return((0,c.useEffect)(()=>{if(!t)return;let e=e=>{"Escape"===e.key&&s(),"ArrowRight"===e.key&&x(),"ArrowLeft"===e.key&&h()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[t,s,x,h]),t&&"undefined"!=typeof document)?(0,o.createPortal)((0,r.jsxs)("div",{className:"fixed inset-0 z-[9999] bg-black/90 backdrop-blur-sm flex items-center justify-center animate-in fade-in duration-200",children:[(0,r.jsx)("button",{onClick:s,className:"absolute top-4 right-4 text-white/70 hover:text-white transition-colors bg-black/20 p-2 rounded-full hover:bg-white/10",children:(0,r.jsx)(a.Z,{className:"h-8 w-8"})}),d.length>1&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:e=>{e.stopPropagation(),h()},className:"absolute left-4 text-white/70 hover:text-white transition-colors hover:scale-110 p-2",children:(0,r.jsx)(l.Z,{className:"h-10 w-10 sm:h-12 sm:w-12"})}),(0,r.jsx)("button",{onClick:e=>{e.stopPropagation(),x()},className:"absolute right-4 text-white/70 hover:text-white transition-colors hover:scale-110 p-2",children:(0,r.jsx)(n.Z,{className:"h-10 w-10 sm:h-12 sm:w-12"})})]}),(0,r.jsx)("div",{className:"relative w-full h-full max-w-[90vw] max-h-[90vh] flex items-center justify-center pointer-events-none",children:(0,r.jsx)("div",{className:"relative w-full h-full pointer-events-auto",children:(0,r.jsx)(i.default,{src:d[m],alt:"Foto ".concat(m+1),fill:!0,className:"object-contain",quality:90,priority:!0})})}),d.length>1&&(0,r.jsxs)("div",{className:"absolute bottom-6 left-1/2 -translate-x-1/2 text-white/80 font-medium bg-black/40 px-3 py-1 rounded-full text-sm",children:[m+1," / ",d.length]})]}),document.body):null}},2782:function(e,t,s){"use strict";s.d(t,{I:function(){return n}});var r=s(3827),a=s(4090),l=s(2169);let n=a.forwardRef((e,t)=>{let{className:s,type:a,...n}=e;return(0,r.jsx)("input",{type:a,className:(0,l.cn)("flex h-11 w-full rounded-md border border-input bg-background px-4 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 transition-all",s),ref:t,...n})});n.displayName="Input"},3549:function(e,t,s){"use strict";s.d(t,{g:function(){return n}});var r=s(3827),a=s(4090),l=s(2169);let n=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("textarea",{className:(0,l.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-4 py-3 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...a})});n.displayName="Textarea"},7290:function(e,t,s){"use strict";s.d(t,{A:function(){return a}});var r=s(6288);function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";switch(t){case"success":r.Am.success(e);break;case"error":r.Am.error(e);break;case"warning":r.Am.warning(e);break;default:r.Am.info(e)}}}},function(e){e.O(0,[55,380,288,248,861,971,69,744],function(){return e(e.s=6108)}),_N_E=e.O()}]);